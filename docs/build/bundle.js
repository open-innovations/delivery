var app=function(){"use strict";function e(){}function t(e,t){for(const r in t)e[r]=t[r];return e}function r(e){return e()}function n(){return Object.create(null)}function o(e){e.forEach(r)}function i(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function s(t,...r){if(null==t)return e;const n=t.subscribe(...r);return n.unsubscribe?()=>n.unsubscribe():n}function c(e,t,r){e.$$.on_destroy.push(s(t,r))}function u(e,t){e.appendChild(t)}function l(e,t,r){e.insertBefore(t,r||null)}function d(e){e.parentNode.removeChild(e)}function h(e){return document.createElement(e)}function p(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function f(e){return document.createTextNode(e)}function g(){return f(" ")}function y(e,t,r){null==r?e.removeAttribute(t):e.getAttribute(t)!==r&&e.setAttribute(t,r)}function m(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function v(e,t,r){e.classList[r?"add":"remove"](t)}let E;function C(e){E=e}const w=[],T=[],S=[],A=[],_=Promise.resolve();let I=!1;function b(e){S.push(e)}let R=!1;const O=new Set;function k(){if(!R){R=!0;do{for(let e=0;e<w.length;e+=1){const t=w[e];C(t),N(t.$$)}for(C(null),w.length=0;T.length;)T.pop()();for(let e=0;e<S.length;e+=1){const t=S[e];O.has(t)||(O.add(t),t())}S.length=0}while(w.length);for(;A.length;)A.pop()();I=!1,R=!1,O.clear()}}function N(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(b)}}const P=new Set;let U;function M(){U={r:0,c:[],p:U}}function L(){U.r||o(U.c),U=U.p}function H(e,t){e&&e.i&&(P.delete(e),e.i(t))}function D(e,t,r,n){if(e&&e.o){if(P.has(e))return;P.add(e),U.c.push((()=>{P.delete(e),n&&(r&&e.d(1),n())})),e.o(t)}}function q(e){e&&e.c()}function F(e,t,n,a){const{fragment:s,on_mount:c,on_destroy:u,after_update:l}=e.$$;s&&s.m(t,n),a||b((()=>{const t=c.map(r).filter(i);u?u.push(...t):o(t),e.$$.on_mount=[]})),l.forEach(b)}function x(e,t){const r=e.$$;null!==r.fragment&&(o(r.on_destroy),r.fragment&&r.fragment.d(t),r.on_destroy=r.fragment=null,r.ctx=[])}function K(e,t){-1===e.$$.dirty[0]&&(w.push(e),I||(I=!0,_.then(k)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function G(t,r,i,a,s,c,u,l=[-1]){const h=E;C(t);const p=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(h?h.$$.context:[])),callbacks:n(),dirty:l,skip_bound:!1,root:r.target||h.$$.root};u&&u(p.root);let f=!1;if(p.ctx=i?i(t,r.props||{},((e,r,...n)=>{const o=n.length?n[0]:r;return p.ctx&&s(p.ctx[e],p.ctx[e]=o)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](o),f&&K(t,e)),r})):[],p.update(),f=!0,o(p.before_update),p.fragment=!!a&&a(p.ctx),r.target){if(r.hydrate){const e=function(e){return Array.from(e.childNodes)}(r.target);p.fragment&&p.fragment.l(e),e.forEach(d)}else p.fragment&&p.fragment.c();r.intro&&H(t.$$.fragment),F(t,r.target,r.anchor,r.customElement),k()}C(h)}class B{$destroy(){x(this,1),this.$destroy=e}$on(e,t){const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(t),()=>{const e=r.indexOf(t);-1!==e&&r.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function j(t){let r,n;return{c(){r=p("svg"),n=p("path"),y(n,"d","M3.094 0c-.06 0-.105.044-.125.094l-2.938 6.813-.031.188v.813c0 .06.034.094.094.094h6.813c.06 0 .094-.034.094-.094v-.813l-.031-.188-2.938-6.813c-.02-.05-.065-.094-.125-.094h-.813zm-.094 3h1v2h-1v-2zm0 3h1v1h-1v-1z"),y(r,"xmlns","http://www.w3.org/2000/svg"),y(r,"version","1.1"),y(r,"data-icon","warning"),y(r,"viewBox","0 0 8 8")},m(e,t){l(e,r,t),u(r,n)},p:e,i:e,o:e,d(e){e&&d(r)}}}class z extends B{constructor(e){super(),G(this,e,null,j,a,{})}}function W(e){let t,r,n;return t=new z({}),{c(){q(t.$$.fragment),r=g()},m(e,o){F(t,e,o),l(e,r,o),n=!0},i(e){n||(H(t.$$.fragment,e),n=!0)},o(e){D(t.$$.fragment,e),n=!1},d(e){x(t,e),e&&d(r)}}}function $(e){let t;return{c(){t=f(e[1])},m(e,r){l(e,t,r)},p(e,r){2&r&&m(t,e[1])},d(e){e&&d(t)}}}function Y(e){let t,r;return{c(){t=h("a"),r=f(e[1]),y(t,"href",e[3])},m(e,n){l(e,t,n),u(t,r)},p(e,n){2&n&&m(r,e[1]),8&n&&y(t,"href",e[3])},d(e){e&&d(t)}}}function V(e){let t,r,n,o,i,a,s,c,p,E,C,w,T,S,A,_,I,b,R,O,k,N,P,U,q,F,x,K,G,B,j,z,V,Q,J,X,Z,ee,te=e[9].toDateString()+"",re=e[5]?"&pound;"+e[5]:"Not captured",ne=e[10]&&W();function oe(e,t){return e[3]?Y:$}let ie=oe(e),ae=ie(e);return{c(){t=h("section"),r=h("h1"),ne&&ne.c(),n=f(""),ae.c(),o=g(),i=h("table"),a=h("tr"),s=h("th"),s.textContent="Project ID",c=h("td"),p=f(e[0]),E=g(),C=h("tr"),w=h("th"),w.textContent="Customer",T=h("td"),S=f(e[2]),A=g(),_=h("tr"),I=h("th"),I.textContent="Status",b=h("td"),R=f(e[7]),k=g(),N=h("tr"),P=h("th"),P.textContent="Stage",U=h("td"),q=f(e[4]),F=g(),x=h("tr"),K=h("th"),K.textContent="Due date",G=h("td"),B=f(te),j=g(),z=h("tr"),V=h("th"),V.textContent="Value",Q=h("td"),J=g(),X=h("p"),Z=f(e[6]),y(r,"class","svelte-1ghldi8"),y(s,"class","svelte-1ghldi8"),y(c,"class","svelte-1ghldi8"),y(w,"class","svelte-1ghldi8"),y(T,"class","svelte-1ghldi8"),y(I,"class","svelte-1ghldi8"),y(b,"class",O="status "+e[7]+" svelte-1ghldi8"),y(P,"class","svelte-1ghldi8"),y(U,"class","svelte-1ghldi8"),y(K,"class","svelte-1ghldi8"),y(G,"class","svelte-1ghldi8"),y(V,"class","svelte-1ghldi8"),y(Q,"class","svelte-1ghldi8"),y(i,"class","svelte-1ghldi8"),y(t,"class","svelte-1ghldi8"),v(t,"dropped","dropped"===e[8])},m(e,d){l(e,t,d),u(t,r),ne&&ne.m(r,null),u(r,n),ae.m(r,null),u(t,o),u(t,i),u(i,a),u(a,s),u(a,c),u(c,p),u(i,E),u(i,C),u(C,w),u(C,T),u(T,S),u(i,A),u(i,_),u(_,I),u(_,b),u(b,R),u(i,k),u(i,N),u(N,P),u(N,U),u(U,q),u(i,F),u(i,x),u(x,K),u(x,G),u(G,B),u(i,j),u(i,z),u(z,V),u(z,Q),Q.innerHTML=re,u(t,J),u(t,X),u(X,Z),ee=!0},p(e,[o]){e[10]?ne?1024&o&&H(ne,1):(ne=W(),ne.c(),H(ne,1),ne.m(r,n)):ne&&(M(),D(ne,1,1,(()=>{ne=null})),L()),ie===(ie=oe(e))&&ae?ae.p(e,o):(ae.d(1),ae=ie(e),ae&&(ae.c(),ae.m(r,null))),(!ee||1&o)&&m(p,e[0]),(!ee||4&o)&&m(S,e[2]),(!ee||128&o)&&m(R,e[7]),(!ee||128&o&&O!==(O="status "+e[7]+" svelte-1ghldi8"))&&y(b,"class",O),(!ee||16&o)&&m(q,e[4]),(!ee||512&o)&&te!==(te=e[9].toDateString()+"")&&m(B,te),(!ee||32&o)&&re!==(re=e[5]?"&pound;"+e[5]:"Not captured")&&(Q.innerHTML=re),(!ee||64&o)&&m(Z,e[6]),256&o&&v(t,"dropped","dropped"===e[8])},i(e){ee||(H(ne),ee=!0)},o(e){D(ne),ee=!1},d(e){e&&d(t),ne&&ne.d(),ae.d()}}}function Q(e,t,r){let n,{id:o}=t,{name:i}=t,{customer:a}=t,{link:s}=t,{stage:c}=t,{value:u}=t,{note:l}=t,{rag:d}=t,{state:h}=t,{due_by:p}=t;return e.$$set=e=>{"id"in e&&r(0,o=e.id),"name"in e&&r(1,i=e.name),"customer"in e&&r(2,a=e.customer),"link"in e&&r(3,s=e.link),"stage"in e&&r(4,c=e.stage),"value"in e&&r(5,u=e.value),"note"in e&&r(6,l=e.note),"rag"in e&&r(7,d=e.rag),"state"in e&&r(8,h=e.state),"due_by"in e&&r(9,p=e.due_by)},e.$$.update=()=>{256&e.$$.dirty&&r(10,n="blocked"===h)},[o,i,a,s,c,u,l,d,h,p,n]}class J extends B{constructor(e){super(),G(this,e,Q,V,a,{id:0,name:1,customer:2,link:3,stage:4,value:5,note:6,rag:7,state:8,due_by:9})}}function X(t){let r,n,o,a;return{c(){r=h("button"),n=f(t[1]),y(r,"class","svelte-elrlii")},m(e,s){var c,d,h,p;l(e,r,s),u(r,n),o||(d="click",h=function(){i(t[0])&&t[0].apply(this,arguments)},(c=r).addEventListener(d,h,p),a=()=>c.removeEventListener(d,h,p),o=!0)},p(e,[r]){t=e,2&r&&m(n,t[1])},i:e,o:e,d(e){e&&d(r),o=!1,a()}}}function Z(e,t,r){let{handler:n}=t,{name:o}=t;return e.$$set=e=>{"handler"in e&&r(0,n=e.handler),"name"in e&&r(1,o=e.name)},[n,o]}class ee extends B{constructor(e){super(),G(this,e,Z,X,a,{handler:0,name:1})}}const te=[];function re(t,r=e){let n;const o=new Set;function i(e){if(a(t,e)&&(t=e,n)){const e=!te.length;for(const e of o)e[1](),te.push(e,t);if(e){for(let e=0;e<te.length;e+=2)te[e][0](te[e+1]);te.length=0}}}return{set:i,update:function(e){i(e(t))},subscribe:function(a,s=e){const c=[a,s];return o.add(c),1===o.size&&(n=r(i)||e),a(t),()=>{o.delete(c),0===o.size&&(n(),n=null)}}}}function ne(t,r,n){const a=!Array.isArray(t),c=a?[t]:t,u=r.length<2;return l=t=>{let n=!1;const l=[];let d=0,h=e;const p=()=>{if(d)return;h();const n=r(a?l[0]:l,t);u?t(n):h=i(n)?n:e},f=c.map(((e,t)=>s(e,(e=>{l[t]=e,d&=~(1<<t),n&&p()}),(()=>{d|=1<<t}))));return n=!0,p(),function(){o(f),h()}},{subscribe:re(n,l).subscribe};var l}const oe=e=>{const t={due_by:e=>new Date(e),value:e=>parseFloat(e)};return e in t?t[e]:e=>e};async function ie(){const e=await fetch("data/projects.csv"),t=await e.text();return function(e){const[t,...r]=e;return r.map((e=>t.reduce(((t,r,n)=>Object.assign(Object.assign({},t),{[r]:oe(r)(e[n])})),{})))}(t.split("\n").filter((e=>Boolean(e))).map((e=>e.split(","))))}const ae=function(){const{subscribe:e,set:t}=re([]),r=async()=>t(await ie());return r(),{subscribe:e,refresh:r}}();function se(e,t,r){const n=e.slice();return n[1]=t[r],n}function ce(e){let r,n,o,i;const a=[e[1]];let s={};for(let e=0;e<a.length;e+=1)s=t(s,a[e]);return n=new J({props:s}),{c(){r=h("li"),q(n.$$.fragment),o=g(),y(r,"class","svelte-198q31w")},m(e,t){l(e,r,t),F(n,r,null),u(r,o),i=!0},p(e,t){const r=1&t?function(e,t){const r={},n={},o={$$scope:1};let i=e.length;for(;i--;){const a=e[i],s=t[i];if(s){for(const e in a)e in s||(n[e]=1);for(const e in s)o[e]||(r[e]=s[e],o[e]=1);e[i]=s}else for(const e in a)o[e]=1}for(const e in n)e in r||(r[e]=void 0);return r}(a,[(o=e[1],"object"==typeof o&&null!==o?o:{})]):{};var o;n.$set(r)},i(e){i||(H(n.$$.fragment,e),i=!0)},o(e){D(n.$$.fragment,e),i=!1},d(e){e&&d(r),x(n)}}}function ue(e){let t,r,n,o,i,a;n=new ee({props:{handler:ae.refresh,name:"Refresh Data"}});let s=e[0],c=[];for(let t=0;t<s.length;t+=1)c[t]=ce(se(e,s,t));const p=e=>D(c[e],1,1,(()=>{c[e]=null}));return{c(){t=h("section"),r=h("nav"),q(n.$$.fragment),o=g(),i=h("ul");for(let e=0;e<c.length;e+=1)c[e].c();y(r,"class","svelte-198q31w"),y(i,"class","svelte-198q31w")},m(e,s){l(e,t,s),u(t,r),F(n,r,null),u(t,o),u(t,i);for(let e=0;e<c.length;e+=1)c[e].m(i,null);a=!0},p(e,[t]){if(1&t){let r;for(s=e[0],r=0;r<s.length;r+=1){const n=se(e,s,r);c[r]?(c[r].p(n,t),H(c[r],1)):(c[r]=ce(n),c[r].c(),H(c[r],1),c[r].m(i,null))}for(M(),r=s.length;r<c.length;r+=1)p(r);L()}},i(e){if(!a){H(n.$$.fragment,e);for(let e=0;e<s.length;e+=1)H(c[e]);a=!0}},o(e){D(n.$$.fragment,e),c=c.filter(Boolean);for(let e=0;e<c.length;e+=1)D(c[e]);a=!1},d(e){e&&d(t),x(n),function(e,t){for(let r=0;r<e.length;r+=1)e[r]&&e[r].d(t)}(c,e)}}}function le(e,t,r){let n;return c(e,ae,(e=>r(0,n=e))),[n]}class de extends B{constructor(e){super(),G(this,e,le,ue,a,{})}}
/*! @azure/msal-browser v2.18.0 2021-10-05 */
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var he=function(e,t){return he=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},he(e,t)};function pe(e,t){function r(){this.constructor=e}he(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var fe=function(){return fe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},fe.apply(this,arguments)};function ge(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function ye(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function me(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function ve(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(me(arguments[t]));return e}
/*! @azure/msal-common v5.0.1 2021-10-05 */
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var Ee=function(e,t){return Ee=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},Ee(e,t)};function Ce(e,t){function r(){this.constructor=e}Ee(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var we=function(){return we=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},we.apply(this,arguments)};function Te(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function Se(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function Ae(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n}
/*! @azure/msal-common v5.0.1 2021-10-05 */var _e,Ie,be,Re,Oe,ke={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",ADFS:"adfs",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},Ne=[ke.OPENID_SCOPE,ke.PROFILE_SCOPE,ke.OFFLINE_ACCESS_SCOPE],Pe=Ae(Ne,[ke.EMAIL_SCOPE]);!function(e){e.CONTENT_TYPE="Content-Type",e.RETRY_AFTER="Retry-After",e.CCS_HEADER="X-AnchorMailbox"}(_e||(_e={})),function(e){e.ID_TOKEN="idtoken",e.CLIENT_INFO="client.info",e.ADAL_ID_TOKEN="adal.idtoken",e.ERROR="error",e.ERROR_DESC="error.description",e.ACTIVE_ACCOUNT="active-account"}(Ie||(Ie={})),function(e){e.COMMON="common",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers"}(be||(be={})),function(e){e.CLIENT_ID="client_id",e.REDIRECT_URI="redirect_uri",e.RESPONSE_TYPE="response_type",e.RESPONSE_MODE="response_mode",e.GRANT_TYPE="grant_type",e.CLAIMS="claims",e.SCOPE="scope",e.ERROR="error",e.ERROR_DESCRIPTION="error_description",e.ACCESS_TOKEN="access_token",e.ID_TOKEN="id_token",e.REFRESH_TOKEN="refresh_token",e.EXPIRES_IN="expires_in",e.STATE="state",e.NONCE="nonce",e.PROMPT="prompt",e.SESSION_STATE="session_state",e.CLIENT_INFO="client_info",e.CODE="code",e.CODE_CHALLENGE="code_challenge",e.CODE_CHALLENGE_METHOD="code_challenge_method",e.CODE_VERIFIER="code_verifier",e.CLIENT_REQUEST_ID="client-request-id",e.X_CLIENT_SKU="x-client-SKU",e.X_CLIENT_VER="x-client-VER",e.X_CLIENT_OS="x-client-OS",e.X_CLIENT_CPU="x-client-CPU",e.X_CLIENT_CURR_TELEM="x-client-current-telemetry",e.X_CLIENT_LAST_TELEM="x-client-last-telemetry",e.X_MS_LIB_CAPABILITY="x-ms-lib-capability",e.POST_LOGOUT_URI="post_logout_redirect_uri",e.ID_TOKEN_HINT="id_token_hint",e.DEVICE_CODE="device_code",e.CLIENT_SECRET="client_secret",e.CLIENT_ASSERTION="client_assertion",e.CLIENT_ASSERTION_TYPE="client_assertion_type",e.TOKEN_TYPE="token_type",e.REQ_CNF="req_cnf",e.OBO_ASSERTION="assertion",e.REQUESTED_TOKEN_USE="requested_token_use",e.ON_BEHALF_OF="on_behalf_of",e.FOCI="foci",e.CCS_HEADER="X-AnchorMailbox"}(Re||(Re={})),function(e){e.ACCESS_TOKEN="access_token",e.XMS_CC="xms_cc"}(Oe||(Oe={}));var Ue,Me={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create"};!function(e){e.ACCOUNT="account",e.SID="sid",e.LOGIN_HINT="login_hint",e.ID_TOKEN="id_token",e.DOMAIN_HINT="domain_hint",e.ORGANIZATIONS="organizations",e.CONSUMERS="consumers",e.ACCOUNT_ID="accountIdentifier",e.HOMEACCOUNT_ID="homeAccountIdentifier"}(Ue||(Ue={}));var Le,He,De,qe,Fe,xe,Ke,Ge={PLAIN:"plain",S256:"S256"};!function(e){e.QUERY="query",e.FRAGMENT="fragment",e.FORM_POST="form_post"}(Le||(Le={})),function(e){e.IMPLICIT_GRANT="implicit",e.AUTHORIZATION_CODE_GRANT="authorization_code",e.CLIENT_CREDENTIALS_GRANT="client_credentials",e.RESOURCE_OWNER_PASSWORD_GRANT="password",e.REFRESH_TOKEN_GRANT="refresh_token",e.DEVICE_CODE_GRANT="device_code",e.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer"}(He||(He={})),function(e){e.MSSTS_ACCOUNT_TYPE="MSSTS",e.ADFS_ACCOUNT_TYPE="ADFS",e.MSAV1_ACCOUNT_TYPE="MSA",e.GENERIC_ACCOUNT_TYPE="Generic"}(De||(De={})),function(e){e.CACHE_KEY_SEPARATOR="-",e.CLIENT_INFO_SEPARATOR="."}(qe||(qe={})),function(e){e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",e.REFRESH_TOKEN="RefreshToken"}(Fe||(Fe={})),function(e){e.ACCOUNT="Account",e.CREDENTIAL="Credential",e.ID_TOKEN="IdToken",e.ACCESS_TOKEN="AccessToken",e.REFRESH_TOKEN="RefreshToken",e.APP_METADATA="AppMetadata",e.TEMPORARY="TempCache",e.TELEMETRY="Telemetry",e.UNDEFINED="Undefined",e.THROTTLING="Throttling"}(xe||(xe={})),function(e){e[e.ADFS=1001]="ADFS",e[e.MSA=1002]="MSA",e[e.MSSTS=1003]="MSSTS",e[e.GENERIC=1004]="GENERIC",e[e.ACCESS_TOKEN=2001]="ACCESS_TOKEN",e[e.REFRESH_TOKEN=2002]="REFRESH_TOKEN",e[e.ID_TOKEN=2003]="ID_TOKEN",e[e.APP_METADATA=3001]="APP_METADATA",e[e.UNDEFINED=9999]="UNDEFINED"}(Ke||(Ke={}));var Be,je="appmetadata",ze="1",We="authority-metadata",$e=86400;!function(e){e.CONFIG="config",e.CACHE="cache",e.NETWORK="network"}(Be||(Be={}));var Ye,Ve={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"};!function(e){e.POP="pop",e.BEARER="Bearer"}(Ye||(Ye={}));var Qe,Je,Xe,Ze,et,tt=60,rt=3600,nt="throttling",ot="retry-after, h429",it="invalid_grant",at="client_mismatch";!function(e){e.username="username",e.password="password"}(Qe||(Qe={})),function(e){e[e.httpSuccess=200]="httpSuccess",e[e.httpBadRequest=400]="httpBadRequest"}(Je||(Je={})),function(e){e.FAILED_AUTO_DETECTION="1",e.INTERNAL_CACHE="2",e.ENVIRONMENT_VARIABLE="3",e.IMDS="4"}(Xe||(Xe={})),function(e){e.CONFIGURED_MATCHES_DETECTED="1",e.CONFIGURED_NO_AUTO_DETECTION="2",e.CONFIGURED_NOT_DETECTED="3",e.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",e.AUTO_DETECTION_REQUESTED_FAILED="5"}(Ze||(Ze={})),function(e){e.NO_CACHE_HIT="0",e.FORCE_REFRESH="1",e.NO_CACHED_ACCESS_TOKEN="2",e.CACHED_ACCESS_TOKEN_EXPIRED="3",e.REFRESH_CACHED_ACCESS_TOKEN="4"}(et||(et={}));
/*! @azure/msal-common v5.0.1 2021-10-05 */
var st,ct={code:"unexpected_error",desc:"Unexpected error in authentication."},ut=function(e){function t(r,n,o){var i=this,a=n?r+": "+n:r;return i=e.call(this,a)||this,Object.setPrototypeOf(i,t.prototype),i.errorCode=r||ke.EMPTY_STRING,i.errorMessage=n||"",i.subError=o||"",i.name="AuthError",i}return Ce(t,e),t.prototype.setCorrelationId=function(e){this.correlationId=e},t.createUnexpectedError=function(e){return new t(ct.code,ct.desc+": "+e)},t}(Error),lt={createNewGuid:function(){throw ut.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw ut.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw ut.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return Te(this,void 0,void 0,(function(){return Se(this,(function(e){throw"Crypto interface - generatePkceCodes() has not been implemented",ut.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")}))}))},getPublicKeyThumbprint:function(){return Te(this,void 0,void 0,(function(){return Se(this,(function(e){throw"Crypto interface - getPublicKeyThumbprint() has not been implemented",ut.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")}))}))},removeTokenBindingKey:function(){return Te(this,void 0,void 0,(function(){return Se(this,(function(e){throw"Crypto interface - removeTokenBindingKey() has not been implemented",ut.createUnexpectedError("Crypto interface - removeTokenBindingKey() has not been implemented")}))}))},clearKeystore:function(){return Te(this,void 0,void 0,(function(){return Se(this,(function(e){throw"Crypto interface - clearKeystore() has not been implemented",ut.createUnexpectedError("Crypto interface - clearKeystore() has not been implemented")}))}))},signJwt:function(){return Te(this,void 0,void 0,(function(){return Se(this,(function(e){throw"Crypto interface - signJwt() has not been implemented",ut.createUnexpectedError("Crypto interface - signJwt() has not been implemented")}))}))}},dt={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},ht={code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},pt={code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},ft={code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},gt={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},yt={code:"network_error",desc:"Network request failed. Please check network trace to determine root cause."},mt={code:"openid_config_error",desc:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints."},vt={code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},Et={code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},Ct={code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},wt={code:"state_not_found",desc:"State not found"},Tt={code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},St={code:"nonce_not_found",desc:"nonce not found"},At={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},_t={code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},It={code:"multiple_matching_appMetadata",desc:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata"},bt={code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},Rt={code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},Ot={code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},kt={code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},Nt={code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},Pt={code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},Ut={code:"device_code_expired",desc:"Device code is expired."},Mt={code:"device_code_unknown_error",desc:"Device code stopped polling for unknown reasons."},Lt={code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},Ht={code:"invalid_cache_record",desc:"Cache record object was null or undefined."},Dt={code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},qt={code:"no_account_found",desc:"No account found in cache for given key."},Ft={code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},xt={code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},Kt={code:"invalid_cache_type",desc:"Invalid cache type"},Gt={code:"unexpected_account_type",desc:"Unexpected account type."},Bt={code:"unexpected_credential_type",desc:"Unexpected credential type."},jt={code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},zt={code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},Wt={code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},$t={code:"user_timeout_reached",desc:"User defined timeout for device code polling reached"},Yt={code:"token_claims_cnf_required_for_signedjwt",desc:"Cannot generate a POP jwt if the token_claims are not populated"},Vt={code:"authorization_code_missing_from_server_response",desc:"Server response does not contain an authorization code to proceed"},Qt={code:"binding_key_not_removed",desc:"Could not remove the credential's binding key from storage."},Jt=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientAuthError",Object.setPrototypeOf(o,t.prototype),o}return Ce(t,e),t.createClientInfoDecodingError=function(e){return new t(dt.code,dt.desc+" Failed with error: "+e)},t.createClientInfoEmptyError=function(){return new t(ht.code,""+ht.desc)},t.createTokenParsingError=function(e){return new t(pt.code,pt.desc+" Failed with error: "+e)},t.createTokenNullOrEmptyError=function(e){return new t(ft.code,ft.desc+" Raw Token Value: "+e)},t.createEndpointDiscoveryIncompleteError=function(e){return new t(gt.code,gt.desc+" Detail: "+e)},t.createNetworkError=function(e,r){return new t(yt.code,yt.desc+" | Fetch client threw: "+r+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToGetOpenidConfigError=function(e){return new t(mt.code,mt.desc+" Attempted to retrieve endpoints from: "+e)},t.createHashNotDeserializedError=function(e){return new t(vt.code,vt.desc+" Given Object: "+e)},t.createInvalidStateError=function(e,r){return new t(Et.code,Et.desc+" Invalid State: "+e+", Root Err: "+r)},t.createStateMismatchError=function(){return new t(Ct.code,Ct.desc)},t.createStateNotFoundError=function(e){return new t(wt.code,wt.desc+":  "+e)},t.createNonceMismatchError=function(){return new t(Tt.code,Tt.desc)},t.createNonceNotFoundError=function(e){return new t(St.code,St.desc+":  "+e)},t.createMultipleMatchingTokensInCacheError=function(){return new t(At.code,At.desc+".")},t.createMultipleMatchingAccountsInCacheError=function(){return new t(_t.code,_t.desc)},t.createMultipleMatchingAppMetadataInCacheError=function(){return new t(It.code,It.desc)},t.createTokenRequestCannotBeMadeError=function(){return new t(bt.code,bt.desc)},t.createAppendEmptyScopeToSetError=function(e){return new t(Rt.code,Rt.desc+" Given Scope: "+e)},t.createRemoveEmptyScopeFromSetError=function(e){return new t(Ot.code,Ot.desc+" Given Scope: "+e)},t.createAppendScopeSetError=function(e){return new t(kt.code,kt.desc+" Detail Error: "+e)},t.createEmptyInputScopeSetError=function(){return new t(Nt.code,""+Nt.desc)},t.createDeviceCodeCancelledError=function(){return new t(Pt.code,""+Pt.desc)},t.createDeviceCodeExpiredError=function(){return new t(Ut.code,""+Ut.desc)},t.createDeviceCodeUnknownError=function(){return new t(Mt.code,""+Mt.desc)},t.createNoAccountInSilentRequestError=function(){return new t(Lt.code,""+Lt.desc)},t.createNullOrUndefinedCacheRecord=function(){return new t(Ht.code,Ht.desc)},t.createInvalidCacheEnvironmentError=function(){return new t(Dt.code,Dt.desc)},t.createNoAccountFoundError=function(){return new t(qt.code,qt.desc)},t.createCachePluginError=function(){return new t(Ft.code,""+Ft.desc)},t.createNoCryptoObjectError=function(e){return new t(xt.code,""+xt.desc+e)},t.createInvalidCacheTypeError=function(){return new t(Kt.code,""+Kt.desc)},t.createUnexpectedAccountTypeError=function(){return new t(Gt.code,""+Gt.desc)},t.createUnexpectedCredentialTypeError=function(){return new t(Bt.code,""+Bt.desc)},t.createInvalidAssertionError=function(){return new t(jt.code,""+jt.desc)},t.createInvalidCredentialError=function(){return new t(zt.code,""+zt.desc)},t.createRefreshRequiredError=function(){return new t(Wt.code,Wt.desc)},t.createUserTimeoutReachedError=function(){return new t($t.code,$t.desc)},t.createTokenClaimsRequiredError=function(){return new t(Yt.code,Yt.desc)},t.createNoAuthCodeInServerResponseError=function(){return new t(Vt.code,Vt.desc)},t.createBindingKeyNotRemovedError=function(){return new t(Qt.code,Qt.desc)},t}(ut),Xt=function(){function e(){}return e.decodeAuthToken=function(t){if(e.isEmpty(t))throw Jt.createTokenNullOrEmptyError(t);var r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(t);if(!r||r.length<4)throw Jt.createTokenParsingError("Given token is malformed: "+JSON.stringify(t));return{header:r[1],JWSPayload:r[2],JWSSig:r[3]}},e.isEmpty=function(e){return void 0===e||!e||0===e.length},e.isEmptyObj=function(t){if(t&&!e.isEmpty(t))try{var r=JSON.parse(t);return 0===Object.keys(r).length}catch(e){}return!0},e.startsWith=function(e,t){return 0===e.indexOf(t)},e.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},e.queryStringToObject=function(e){var t={},r=e.split("&"),n=function(e){return decodeURIComponent(e.replace(/\+/g," "))};return r.forEach((function(e){if(e.trim()){var r=e.split(/=(.+)/g,2),o=r[0],i=r[1];o&&i&&(t[n(o)]=n(i))}})),t},e.trimArrayEntries=function(e){return e.map((function(e){return e.trim()}))},e.removeEmptyStringsFromArray=function(t){return t.filter((function(t){return!e.isEmpty(t)}))},e.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(e){return null}},e.matchPattern=function(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)},e}();!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose",e[e.Trace=4]="Trace"}(st||(st={}));var Zt,er=function(){function e(e,t,r){this.level=st.Info;this.localCallback=e.loggerCallback||function(){},this.piiLoggingEnabled=e.piiLoggingEnabled||!1,this.level="number"==typeof e.logLevel?e.logLevel:st.Info,this.correlationId=e.correlationId||"",this.packageName=t||ke.EMPTY_STRING,this.packageVersion=r||ke.EMPTY_STRING}return e.prototype.clone=function(t,r,n){return new e({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},t,r)},e.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var r=(new Date).toUTCString(),n=(Xt.isEmpty(t.correlationId)?Xt.isEmpty(this.correlationId)?"["+r+"]":"["+r+"] : ["+this.correlationId+"]":"["+r+"] : ["+t.correlationId+"]")+" : "+this.packageName+"@"+this.packageVersion+" : "+st[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,n,t.containsPii||!1)}},e.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},e.prototype.error=function(e,t){this.logMessage(e,{logLevel:st.Error,containsPii:!1,correlationId:t||""})},e.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:st.Error,containsPii:!0,correlationId:t||""})},e.prototype.warning=function(e,t){this.logMessage(e,{logLevel:st.Warning,containsPii:!1,correlationId:t||""})},e.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:st.Warning,containsPii:!0,correlationId:t||""})},e.prototype.info=function(e,t){this.logMessage(e,{logLevel:st.Info,containsPii:!1,correlationId:t||""})},e.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:st.Info,containsPii:!0,correlationId:t||""})},e.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:st.Verbose,containsPii:!1,correlationId:t||""})},e.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:st.Verbose,containsPii:!0,correlationId:t||""})},e.prototype.trace=function(e,t){this.logMessage(e,{logLevel:st.Trace,containsPii:!1,correlationId:t||""})},e.prototype.tracePii=function(e,t){this.logMessage(e,{logLevel:st.Trace,containsPii:!0,correlationId:t||""})},e.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},e}(),tr="5.0.1",rr=function(){function e(){}return e.prototype.generateAccountId=function(){return e.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},e.prototype.generateCredentialId=function(){return e.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},e.prototype.generateTarget=function(){return e.generateTargetForCacheKey(this.target)},e.prototype.generateCredentialKey=function(){return e.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType)},e.prototype.generateType=function(){switch(this.credentialType){case Fe.ID_TOKEN:return Ke.ID_TOKEN;case Fe.ACCESS_TOKEN:case Fe.ACCESS_TOKEN_WITH_AUTH_SCHEME:return Ke.ACCESS_TOKEN;case Fe.REFRESH_TOKEN:return Ke.REFRESH_TOKEN;default:throw Jt.createUnexpectedCredentialTypeError()}},e.getCredentialType=function(e){return-1!==e.indexOf(Fe.ACCESS_TOKEN.toLowerCase())?-1!==e.indexOf(Fe.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())?Fe.ACCESS_TOKEN_WITH_AUTH_SCHEME:Fe.ACCESS_TOKEN:-1!==e.indexOf(Fe.ID_TOKEN.toLowerCase())?Fe.ID_TOKEN:-1!==e.indexOf(Fe.REFRESH_TOKEN.toLowerCase())?Fe.REFRESH_TOKEN:ke.NOT_DEFINED},e.generateCredentialCacheKey=function(e,t,r,n,o,i,a,s){var c=[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,n,o,a),this.generateTargetForCacheKey(i)];return s===Ye.POP&&c.push(s.toLowerCase()),c.join(qe.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateAccountIdForCacheKey=function(e,t){return[e,t].join(qe.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateCredentialIdForCacheKey=function(e,t,r,n){return[e,e===Fe.REFRESH_TOKEN&&n||t,r||""].join(qe.CACHE_KEY_SEPARATOR).toLowerCase()},e.generateTargetForCacheKey=function(e){return(e||"").toLowerCase()},e}(),nr={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},or={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},ir={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},ar={code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},sr={code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},cr={code:"empty_url_error",desc:"URL was empty or null."},ur={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},lr={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},dr={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent', 'create' and 'none'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest"},hr={code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},pr={code:"token_request_empty",desc:"Token request was empty and not found in cache."},fr={code:"logout_request_empty",desc:"The logout request was null or undefined."},gr={code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},yr={code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},mr={code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a JSON object containing tenant_discovery_endpoint and metadata fields"},vr={code:"invalid_authority_metadata",desc:"Invalid authorityMetadata provided. Must by a JSON object containing authorization_endpoint, token_endpoint, end_session_endpoint, issuer fields."},Er={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},Cr=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="ClientConfigurationError",Object.setPrototypeOf(o,t.prototype),o}return Ce(t,e),t.createRedirectUriEmptyError=function(){return new t(nr.code,nr.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(or.code,or.desc)},t.createClaimsRequestParsingError=function(e){return new t(ir.code,ir.desc+" Given value: "+e)},t.createInsecureAuthorityUriError=function(e){return new t(ar.code,ar.desc+" Given URI: "+e)},t.createUrlParseError=function(e){return new t(sr.code,sr.desc+" Given Error: "+e)},t.createUrlEmptyError=function(){return new t(cr.code,cr.desc)},t.createEmptyScopesArrayError=function(){return new t(ur.code,""+ur.desc)},t.createClientIdSingleScopeError=function(e){return new t(lr.code,lr.desc+" Given Scopes: "+e)},t.createInvalidPromptError=function(e){return new t(dr.code,dr.desc+" Given value: "+e)},t.createInvalidClaimsRequestError=function(){return new t(hr.code,hr.desc)},t.createEmptyLogoutRequestError=function(){return new t(fr.code,fr.desc)},t.createEmptyTokenRequestError=function(){return new t(pr.code,pr.desc)},t.createInvalidCodeChallengeMethodError=function(){return new t(gr.code,gr.desc)},t.createInvalidCodeChallengeParamsError=function(){return new t(yr.code,yr.desc)},t.createInvalidCloudDiscoveryMetadataError=function(){return new t(mr.code,mr.desc)},t.createInvalidAuthorityMetadataError=function(){return new t(vr.code,vr.desc)},t.createUntrustedAuthorityError=function(){return new t(Er.code,Er.desc)},t}(Jt),wr=function(){function e(e){var t=this,r=e?Xt.trimArrayEntries(Ae(e)):[],n=r?Xt.removeEmptyStringsFromArray(r):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach((function(e){return t.scopes.add(e)}))}return e.fromString=function(t){return new e((t||"").split(" "))},e.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw Cr.createEmptyScopesArrayError()},e.prototype.containsScope=function(t){var r=new e(this.printScopesLowerCase().split(" "));return!Xt.isEmpty(t)&&r.scopes.has(t.toLowerCase())},e.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&(this.scopes.size>=e.scopes.size&&e.asArray().every((function(e){return t.containsScope(e)})))},e.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return Pe.forEach((function(r){e.containsScope(r)&&(t+=1)})),this.scopes.size===t},e.prototype.appendScope=function(e){Xt.isEmpty(e)||this.scopes.add(e.trim())},e.prototype.appendScopes=function(e){var t=this;try{e.forEach((function(e){return t.appendScope(e)}))}catch(e){throw Jt.createAppendScopeSetError(e)}},e.prototype.removeScope=function(e){if(Xt.isEmpty(e))throw Jt.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},e.prototype.removeOIDCScopes=function(){var e=this;Pe.forEach((function(t){e.scopes.delete(t)}))},e.prototype.unionScopeSets=function(e){if(!e)throw Jt.createEmptyInputScopeSetError();var t=new Set;return e.scopes.forEach((function(e){return t.add(e.toLowerCase())})),this.scopes.forEach((function(e){return t.add(e.toLowerCase())})),t},e.prototype.intersectingScopeSets=function(e){if(!e)throw Jt.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r},e.prototype.getScopeCount=function(){return this.scopes.size},e.prototype.asArray=function(){var e=[];return this.scopes.forEach((function(t){return e.push(t)})),e},e.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):""},e.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},e}();
/*! @azure/msal-common v5.0.1 2021-10-05 */
/*! @azure/msal-common v5.0.1 2021-10-05 */
function Tr(e,t){if(Xt.isEmpty(e))throw Jt.createClientInfoEmptyError();try{var r=t.base64Decode(e);return JSON.parse(r)}catch(e){throw Jt.createClientInfoDecodingError(e)}}function Sr(e){if(Xt.isEmpty(e))throw Jt.createClientInfoDecodingError("Home account ID was empty.");var t=e.split(qe.CLIENT_INFO_SEPARATOR,2);return{uid:t[0],utid:t.length<2?ke.EMPTY_STRING:t[1]}}
/*! @azure/msal-common v5.0.1 2021-10-05 */!function(e){e[e.Default=0]="Default",e[e.Adfs=1]="Adfs"}(Zt||(Zt={}));
/*! @azure/msal-common v5.0.1 2021-10-05 */
var Ar=function(){function e(){}return e.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(qe.CACHE_KEY_SEPARATOR).toLowerCase()},e.prototype.generateAccountKey=function(){return e.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},e.prototype.generateType=function(){switch(this.authorityType){case De.ADFS_ACCOUNT_TYPE:return Ke.ADFS;case De.MSAV1_ACCOUNT_TYPE:return Ke.MSA;case De.MSSTS_ACCOUNT_TYPE:return Ke.MSSTS;case De.GENERIC_ACCOUNT_TYPE:return Ke.GENERIC;default:throw Jt.createUnexpectedAccountTypeError()}},e.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims}},e.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||"",e.tenantId||""].join(qe.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAccount=function(t,r,n,o,i,a,s,c){var u,l,d,h,p,f,g=new e;g.authorityType=De.MSSTS_ACCOUNT_TYPE,g.clientInfo=t,g.homeAccountId=r;var y=c||o&&o.getPreferredCache();if(!y)throw Jt.createInvalidCacheEnvironmentError();return g.environment=y,g.realm=(null===(u=null==n?void 0:n.claims)||void 0===u?void 0:u.tid)||"",g.oboAssertion=i,n&&(g.idTokenClaims=n.claims,g.localAccountId=(null===(l=null==n?void 0:n.claims)||void 0===l?void 0:l.oid)||(null===(d=null==n?void 0:n.claims)||void 0===d?void 0:d.sub)||"",g.username=(null===(h=null==n?void 0:n.claims)||void 0===h?void 0:h.preferred_username)||((null===(p=null==n?void 0:n.claims)||void 0===p?void 0:p.emails)?n.claims.emails[0]:""),g.name=null===(f=null==n?void 0:n.claims)||void 0===f?void 0:f.name),g.cloudGraphHostName=a,g.msGraphHost=s,g},e.createGenericAccount=function(t,r,n,o,i,a,s){var c,u,l,d,h=new e;h.authorityType=n&&n.authorityType===Zt.Adfs?De.ADFS_ACCOUNT_TYPE:De.GENERIC_ACCOUNT_TYPE,h.homeAccountId=t,h.realm="",h.oboAssertion=o;var p=s||n&&n.getPreferredCache();if(!p)throw Jt.createInvalidCacheEnvironmentError();return r&&(h.localAccountId=(null===(c=null==r?void 0:r.claims)||void 0===c?void 0:c.oid)||(null===(u=null==r?void 0:r.claims)||void 0===u?void 0:u.sub)||"",h.username=(null===(l=null==r?void 0:r.claims)||void 0===l?void 0:l.upn)||"",h.name=(null===(d=null==r?void 0:r.claims)||void 0===d?void 0:d.name)||"",h.idTokenClaims=null==r?void 0:r.claims),h.environment=p,h.cloudGraphHostName=i,h.msGraphHost=a,h},e.generateHomeAccountId=function(e,t,r,n,o){var i,a=(null===(i=null==o?void 0:o.claims)||void 0===i?void 0:i.sub)?o.claims.sub:ke.EMPTY_STRING;if(t===Zt.Adfs)return a;if(e)try{var s=Tr(e,n);if(!Xt.isEmpty(s.uid)&&!Xt.isEmpty(s.utid))return""+s.uid+qe.CLIENT_INFO_SEPARATOR+s.utid}catch(e){}return r.verbose("No client info in response"),a},e.isAccountEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"))},e.accountInfoIsEqual=function(e,t,r){if(!e||!t)return!1;var n=!0;if(r){var o=e.idTokenClaims||{},i=t.idTokenClaims||{};n=o.iat===i.iat&&o.nonce===i.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&n},e}(),_r=function(){function e(t,r){if(Xt.isEmpty(t))throw Jt.createTokenNullOrEmptyError(t);this.rawToken=t,this.claims=e.extractTokenClaims(t,r)}return e.extractTokenClaims=function(e,t){var r=Xt.decodeAuthToken(e);try{var n=r.JWSPayload,o=t.base64Decode(n);return JSON.parse(o)}catch(e){throw Jt.createTokenParsingError(e)}},e}(),Ir=function(){function e(e,t){this.clientId=e,this.cryptoImpl=t}return e.prototype.getAllAccounts=function(){var t=this,r=this.getAccountsFilteredBy(),n=Object.keys(r).map((function(e){return r[e]}));return n.length<1?[]:n.map((function(r){var n=e.toObject(new Ar,r).getAccountInfo(),o=t.readIdTokenFromCache(t.clientId,n);return o&&!n.idTokenClaims&&(n.idTokenClaims=new _r(o.secret,t.cryptoImpl).claims),n}))},e.prototype.saveCacheRecord=function(e){return Te(this,void 0,void 0,(function(){return Se(this,(function(t){switch(t.label){case 0:if(!e)throw Jt.createNullOrUndefinedCacheRecord();return e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken?[4,this.saveAccessToken(e.accessToken)]:[3,2];case 1:t.sent(),t.label=2;case 2:return e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata),[2]}}))}))},e.prototype.saveAccessToken=function(e){return Te(this,void 0,void 0,(function(){var t,r,n,o,i=this;return Se(this,(function(a){switch(a.label){case 0:return t=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType}),r=wr.fromString(e.target),(n=Object.keys(t.accessTokens).map((function(e){return t.accessTokens[e]})))?(o=[],n.forEach((function(e){wr.fromString(e.target).intersectingScopeSets(r)&&o.push(i.removeCredential(e))})),[4,Promise.all(o)]):[3,2];case 1:a.sent(),a.label=2;case 2:return this.setAccessTokenCredential(e),[2]}}))}))},e.prototype.getAccountsFilteredBy=function(e){return this.getAccountsFilteredByInternal(e?e.homeAccountId:"",e?e.environment:"",e?e.realm:"")},e.prototype.getAccountsFilteredByInternal=function(e,t,r){var n=this,o=this.getKeys(),i={};return o.forEach((function(o){var a=n.getAccount(o);a&&(e&&!n.matchHomeAccountId(a,e)||t&&!n.matchEnvironment(a,t)||r&&!n.matchRealm(a,r)||(i[o]=a))})),i},e.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.familyId,e.realm,e.target,e.oboAssertion,e.tokenType)},e.prototype.getCredentialsFilteredByInternal=function(e,t,r,n,o,i,a,s,c){var u=this,l=this.getKeys(),d={idTokens:{},accessTokens:{},refreshTokens:{}};return l.forEach((function(l){var h=rr.getCredentialType(l);if(h!==ke.NOT_DEFINED){var p=u.getSpecificCredential(l,h);if(p&&(!s||u.matchOboAssertion(p,s))&&(!e||u.matchHomeAccountId(p,e))&&(!t||u.matchEnvironment(p,t))&&(!i||u.matchRealm(p,i))&&(!r||u.matchCredentialType(p,r))&&(!n||u.matchClientId(p,n))&&(!o||u.matchFamilyId(p,o))&&(!a||u.matchTarget(p,a))){if(r===Fe.ACCESS_TOKEN_WITH_AUTH_SCHEME){if(c&&!u.matchTokenType(p,c))return;if(-1===l.indexOf(Ye.POP))return void u.removeItem(l,xe.CREDENTIAL)}switch(h){case Fe.ID_TOKEN:d.idTokens[l]=p;break;case Fe.ACCESS_TOKEN:case Fe.ACCESS_TOKEN_WITH_AUTH_SCHEME:d.accessTokens[l]=p;break;case Fe.REFRESH_TOKEN:d.refreshTokens[l]=p}}}})),d},e.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},e.prototype.getAppMetadataFilteredByInternal=function(e,t){var r=this,n=this.getKeys(),o={};return n.forEach((function(n){if(r.isAppMetadata(n)){var i=r.getAppMetadata(n);i&&(e&&!r.matchEnvironment(i,e)||t&&!r.matchClientId(i,t)||(o[n]=i))}})),o},e.prototype.getAuthorityMetadataByAlias=function(e){var t=this,r=this.getAuthorityMetadataKeys(),n=null;return r.forEach((function(r){if(t.isAuthorityMetadata(r)&&-1!==r.indexOf(t.clientId)){var o=t.getAuthorityMetadata(r);o&&-1!==o.aliases.indexOf(e)&&(n=o)}})),n},e.prototype.removeAllAccounts=function(){return Te(this,void 0,void 0,(function(){var e,t,r=this;return Se(this,(function(n){switch(n.label){case 0:return e=this.getKeys(),t=[],e.forEach((function(e){r.getAccount(e)&&t.push(r.removeAccount(e))})),[4,Promise.all(t)];case 1:return n.sent(),[2,!0]}}))}))},e.prototype.removeAccount=function(e){return Te(this,void 0,void 0,(function(){var t;return Se(this,(function(r){switch(r.label){case 0:if(!(t=this.getAccount(e)))throw Jt.createNoAccountFoundError();return[4,this.removeAccountContext(t)];case 1:return[2,r.sent()&&this.removeItem(e,xe.ACCOUNT)]}}))}))},e.prototype.removeAccountContext=function(e){return Te(this,void 0,void 0,(function(){var t,r,n,o=this;return Se(this,(function(i){switch(i.label){case 0:return t=this.getKeys(),r=e.generateAccountId(),n=[],t.forEach((function(e){var t=rr.getCredentialType(e);if(t!==ke.NOT_DEFINED){var i=o.getSpecificCredential(e,t);i&&r===i.generateAccountId()&&n.push(o.removeCredential(i))}})),[4,Promise.all(n)];case 1:return i.sent(),[2,!0]}}))}))},e.prototype.removeCredential=function(e){return Te(this,void 0,void 0,(function(){var t,r;return Se(this,(function(n){switch(n.label){case 0:if(t=e.generateCredentialKey(),e.credentialType.toLowerCase()!==Fe.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(!(r=e.keyId))return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(r)];case 2:return n.sent(),[3,4];case 3:throw n.sent(),Jt.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(t,xe.CREDENTIAL)]}}))}))},e.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach((function(t){e.isAppMetadata(t)&&e.removeItem(t,xe.APP_METADATA)})),!0},e.prototype.readCacheRecord=function(e,t,r,n,o){var i=this.readAccountFromCache(e),a=this.readIdTokenFromCache(t,e),s=this.readAccessTokenFromCache(t,e,r,o),c=this.readRefreshTokenFromCache(t,e,!1),u=this.readAppMetadataFromCache(n,t);return i&&a&&(i.idTokenClaims=new _r(a.secret,this.cryptoImpl).claims),{account:i,idToken:a,accessToken:s,refreshToken:c,appMetadata:u}},e.prototype.readAccountFromCache=function(e){var t=Ar.generateAccountCacheKey(e);return this.getAccount(t)},e.prototype.readIdTokenFromCache=function(e,t){var r={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:Fe.ID_TOKEN,clientId:e,realm:t.tenantId},n=this.getCredentialsFilteredBy(r),o=Object.keys(n.idTokens).map((function(e){return n.idTokens[e]})),i=o.length;if(i<1)return null;if(i>1)throw Jt.createMultipleMatchingTokensInCacheError();return o[0]},e.prototype.readAccessTokenFromCache=function(e,t,r,n){var o=n===Ye.POP?Fe.ACCESS_TOKEN_WITH_AUTH_SCHEME:Fe.ACCESS_TOKEN,i={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:o,clientId:e,realm:t.tenantId,target:r.printScopesLowerCase(),tokenType:n},a=this.getCredentialsFilteredBy(i),s=Object.keys(a.accessTokens).map((function(e){return a.accessTokens[e]})),c=s.length;if(c<1)return null;if(c>1)throw Jt.createMultipleMatchingTokensInCacheError();return s[0]},e.prototype.readRefreshTokenFromCache=function(e,t,r){var n=r?ze:void 0,o={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:Fe.REFRESH_TOKEN,clientId:e,familyId:n},i=this.getCredentialsFilteredBy(o),a=Object.keys(i.refreshTokens).map((function(e){return i.refreshTokens[e]}));return a.length<1?null:a[0]},e.prototype.readAppMetadataFromCache=function(e,t){var r={environment:e,clientId:t},n=this.getAppMetadataFilteredBy(r),o=Object.keys(n).map((function(e){return n[e]})),i=o.length;if(i<1)return null;if(i>1)throw Jt.createMultipleMatchingAppMetadataInCacheError();return o[0]},e.prototype.isAppMetadataFOCI=function(e,t){var r=this.readAppMetadataFromCache(e,t);return!(!r||r.familyId!==ze)},e.prototype.matchHomeAccountId=function(e,t){return!(!e.homeAccountId||t!==e.homeAccountId)},e.prototype.matchOboAssertion=function(e,t){return!(!e.oboAssertion||t!==e.oboAssertion)},e.prototype.matchEnvironment=function(e,t){var r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)},e.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},e.prototype.matchClientId=function(e,t){return!(!e.clientId||t!==e.clientId)},e.prototype.matchFamilyId=function(e,t){return!(!e.familyId||t!==e.familyId)},e.prototype.matchRealm=function(e,t){return!(!e.realm||t!==e.realm)},e.prototype.matchTarget=function(e,t){if(e.credentialType!==Fe.ACCESS_TOKEN&&e.credentialType!==Fe.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;var r=wr.fromString(e.target),n=wr.fromString(t);return n.containsOnlyOIDCScopes()?n.removeScope(ke.OFFLINE_ACCESS_SCOPE):n.removeOIDCScopes(),r.containsScopeSet(n)},e.prototype.matchTokenType=function(e,t){return!(!e.tokenType||e.tokenType!==t)},e.prototype.isAppMetadata=function(e){return-1!==e.indexOf(je)},e.prototype.isAuthorityMetadata=function(e){return-1!==e.indexOf(We)},e.prototype.generateAuthorityMetadataCacheKey=function(e){return We+"-"+this.clientId+"-"+e},e.prototype.getSpecificCredential=function(e,t){switch(t){case Fe.ID_TOKEN:return this.getIdTokenCredential(e);case Fe.ACCESS_TOKEN:case Fe.ACCESS_TOKEN_WITH_AUTH_SCHEME:return this.getAccessTokenCredential(e);case Fe.REFRESH_TOKEN:return this.getRefreshTokenCredential(e);default:return null}},e.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},e}(),br=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ce(t,e),t.prototype.setAccount=function(){throw ut.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},t.prototype.getAccount=function(){throw ut.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},t.prototype.setIdTokenCredential=function(){throw ut.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getIdTokenCredential=function(){throw ut.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAccessTokenCredential=function(){throw ut.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getAccessTokenCredential=function(){throw ut.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setRefreshTokenCredential=function(){throw ut.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.getRefreshTokenCredential=function(){throw ut.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},t.prototype.setAppMetadata=function(){throw ut.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAppMetadata=function(){throw ut.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.setServerTelemetry=function(){throw ut.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.getServerTelemetry=function(){throw ut.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},t.prototype.setAuthorityMetadata=function(){throw ut.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadata=function(){throw ut.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},t.prototype.getAuthorityMetadataKeys=function(){throw ut.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},t.prototype.setThrottlingCache=function(){throw ut.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.getThrottlingCache=function(){throw ut.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},t.prototype.removeItem=function(){throw ut.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},t.prototype.containsKey=function(){throw ut.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},t.prototype.getKeys=function(){throw ut.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},t.prototype.clear=function(){return Te(this,void 0,void 0,(function(){return Se(this,(function(e){throw"Storage interface - clear() has not been implemented for the cacheStorage interface.",ut.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")}))}))},t}(Ir),Rr={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1},Or={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:st.Info,correlationId:""},kr={sendGetRequestAsync:function(){return Te(this,void 0,void 0,(function(){return Se(this,(function(e){throw"Network interface - sendGetRequestAsync() has not been implemented",ut.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")}))}))},sendPostRequestAsync:function(){return Te(this,void 0,void 0,(function(){return Se(this,(function(e){throw"Network interface - sendPostRequestAsync() has not been implemented",ut.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")}))}))}},Nr={sku:ke.SKU,version:tr,cpu:"",os:""},Pr={clientSecret:"",clientAssertion:void 0};
/*! @azure/msal-common v5.0.1 2021-10-05 */
/*! @azure/msal-common v5.0.1 2021-10-05 */
var Ur,Mr=function(e){function t(r,n,o){var i=e.call(this,r,n,o)||this;return i.name="ServerError",Object.setPrototypeOf(i,t.prototype),i}return Ce(t,e),t}(ut),Lr=function(){function e(){}return e.generateThrottlingStorageKey=function(e){return nt+"."+JSON.stringify(e)},e.preProcess=function(t,r){var n,o=e.generateThrottlingStorageKey(r),i=t.getThrottlingCache(o);if(i){if(i.throttleTime<Date.now())return void t.removeItem(o,xe.THROTTLING);throw new Mr((null===(n=i.errorCodes)||void 0===n?void 0:n.join(" "))||ke.EMPTY_STRING,i.errorMessage,i.subError)}},e.postProcess=function(t,r,n){if(e.checkResponseStatus(n)||e.checkResponseForRetryAfter(n)){var o={throttleTime:e.calculateThrottleTime(parseInt(n.headers[_e.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};t.setThrottlingCache(e.generateThrottlingStorageKey(r),o)}},e.checkResponseStatus=function(e){return 429===e.status||e.status>=500&&e.status<600},e.checkResponseForRetryAfter=function(e){return!!e.headers&&(e.headers.hasOwnProperty(_e.RETRY_AFTER)&&(e.status<200||e.status>=300))},e.calculateThrottleTime=function(e){var t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||tt),r+rt))},e.removeThrottle=function(e,t,r,n){var o={clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:n,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims},i=this.generateThrottlingStorageKey(o);return e.removeItem(i,xe.THROTTLING)},e}(),Hr=function(){function e(e,t){this.networkClient=e,this.cacheManager=t}return e.prototype.sendPostRequest=function(e,t,r){return Te(this,void 0,void 0,(function(){var n,o;return Se(this,(function(i){switch(i.label){case 0:Lr.preProcess(this.cacheManager,e),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,r)];case 2:return n=i.sent(),[3,4];case 3:throw(o=i.sent())instanceof ut?o:Jt.createNetworkError(t,o);case 4:return Lr.postProcess(this.cacheManager,e,n),[2,n]}}))}))},e}();
/*! @azure/msal-common v5.0.1 2021-10-05 */!function(e){e.HOME_ACCOUNT_ID="home_account_id",e.UPN="UPN"}(Ur||(Ur={}));
/*! @azure/msal-common v5.0.1 2021-10-05 */
var Dr,qr=function(){function e(e){var t,r,n,o,i,a,s,c,u,l,d,h,p,f;this.config=(n=(t=e).authOptions,o=t.systemOptions,i=t.loggerOptions,a=t.storageInterface,s=t.networkInterface,c=t.cryptoInterface,u=t.clientCredentials,l=t.libraryInfo,d=t.serverTelemetryManager,h=t.persistencePlugin,p=t.serializableCache,f=we(we({},Or),i),{authOptions:(r=n,we({clientCapabilities:[]},r)),systemOptions:we(we({},Rr),o),loggerOptions:f,storageInterface:a||new br(n.clientId,lt),networkInterface:s||kr,cryptoInterface:c||lt,clientCredentials:u||Pr,libraryInfo:we(we({},Nr),l),serverTelemetryManager:d||null,persistencePlugin:h||null,serializableCache:p||null}),this.logger=new er(this.config.loggerOptions,"@azure/msal-common",tr),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new Hr(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority}return e.prototype.createTokenRequestHeaders=function(e){var t={};if(t[_e.CONTENT_TYPE]=ke.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Ur.HOME_ACCOUNT_ID:try{var r=Sr(e.credential);t[_e.CCS_HEADER]="Oid:"+r.uid+"@"+r.utid}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Ur.UPN:t[_e.CCS_HEADER]="UPN: "+e.credential}return t},e.prototype.executePostToTokenEndpoint=function(e,t,r,n){return Te(this,void 0,void 0,(function(){var o;return Se(this,(function(i){switch(i.label){case 0:return[4,this.networkManager.sendPostRequest(n,e,{body:t,headers:r})];case 1:return o=i.sent(),this.config.serverTelemetryManager&&o.status<500&&429!==o.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,o]}}))}))},e.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw Jt.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},e}(),Fr=function(){function e(){}return e.validateRedirectUri=function(e){if(Xt.isEmpty(e))throw Cr.createRedirectUriEmptyError()},e.validatePrompt=function(e){var t=[];for(var r in Me)t.push(Me[r]);if(t.indexOf(e)<0)throw Cr.createInvalidPromptError(e)},e.validateClaims=function(e){try{JSON.parse(e)}catch(e){throw Cr.createInvalidClaimsRequestError()}},e.validateCodeChallengeParams=function(e,t){if(Xt.isEmpty(e)||Xt.isEmpty(t))throw Cr.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},e.validateCodeChallengeMethod=function(e){if([Ge.PLAIN,Ge.S256].indexOf(e)<0)throw Cr.createInvalidCodeChallengeMethodError()},e.sanitizeEQParams=function(e,t){return e?(t.forEach((function(t,r){e[r]&&delete e[r]})),e):{}},e}(),xr=function(){function e(){this.parameters=new Map}return e.prototype.addResponseTypeCode=function(){this.parameters.set(Re.RESPONSE_TYPE,encodeURIComponent(ke.CODE_RESPONSE_TYPE))},e.prototype.addResponseMode=function(e){this.parameters.set(Re.RESPONSE_MODE,encodeURIComponent(e||Le.QUERY))},e.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var r=t?Ae(e||[],Ne):e||[],n=new wr(r);this.parameters.set(Re.SCOPE,encodeURIComponent(n.printScopes()))},e.prototype.addClientId=function(e){this.parameters.set(Re.CLIENT_ID,encodeURIComponent(e))},e.prototype.addRedirectUri=function(e){Fr.validateRedirectUri(e),this.parameters.set(Re.REDIRECT_URI,encodeURIComponent(e))},e.prototype.addPostLogoutRedirectUri=function(e){Fr.validateRedirectUri(e),this.parameters.set(Re.POST_LOGOUT_URI,encodeURIComponent(e))},e.prototype.addIdTokenHint=function(e){this.parameters.set(Re.ID_TOKEN_HINT,encodeURIComponent(e))},e.prototype.addDomainHint=function(e){this.parameters.set(Ue.DOMAIN_HINT,encodeURIComponent(e))},e.prototype.addLoginHint=function(e){this.parameters.set(Ue.LOGIN_HINT,encodeURIComponent(e))},e.prototype.addCcsUpn=function(e){this.parameters.set(_e.CCS_HEADER,encodeURIComponent("UPN:"+e))},e.prototype.addCcsOid=function(e){this.parameters.set(_e.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},e.prototype.addSid=function(e){this.parameters.set(Ue.SID,encodeURIComponent(e))},e.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);Fr.validateClaims(r),this.parameters.set(Re.CLAIMS,encodeURIComponent(r))},e.prototype.addCorrelationId=function(e){this.parameters.set(Re.CLIENT_REQUEST_ID,encodeURIComponent(e))},e.prototype.addLibraryInfo=function(e){this.parameters.set(Re.X_CLIENT_SKU,e.sku),this.parameters.set(Re.X_CLIENT_VER,e.version),this.parameters.set(Re.X_CLIENT_OS,e.os),this.parameters.set(Re.X_CLIENT_CPU,e.cpu)},e.prototype.addPrompt=function(e){Fr.validatePrompt(e),this.parameters.set(""+Re.PROMPT,encodeURIComponent(e))},e.prototype.addState=function(e){Xt.isEmpty(e)||this.parameters.set(Re.STATE,encodeURIComponent(e))},e.prototype.addNonce=function(e){this.parameters.set(Re.NONCE,encodeURIComponent(e))},e.prototype.addCodeChallengeParams=function(e,t){if(Fr.validateCodeChallengeParams(e,t),!e||!t)throw Cr.createInvalidCodeChallengeParamsError();this.parameters.set(Re.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(Re.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},e.prototype.addAuthorizationCode=function(e){this.parameters.set(Re.CODE,encodeURIComponent(e))},e.prototype.addDeviceCode=function(e){this.parameters.set(Re.DEVICE_CODE,encodeURIComponent(e))},e.prototype.addRefreshToken=function(e){this.parameters.set(Re.REFRESH_TOKEN,encodeURIComponent(e))},e.prototype.addCodeVerifier=function(e){this.parameters.set(Re.CODE_VERIFIER,encodeURIComponent(e))},e.prototype.addClientSecret=function(e){this.parameters.set(Re.CLIENT_SECRET,encodeURIComponent(e))},e.prototype.addClientAssertion=function(e){this.parameters.set(Re.CLIENT_ASSERTION,encodeURIComponent(e))},e.prototype.addClientAssertionType=function(e){this.parameters.set(Re.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},e.prototype.addOboAssertion=function(e){this.parameters.set(Re.OBO_ASSERTION,encodeURIComponent(e))},e.prototype.addRequestTokenUse=function(e){this.parameters.set(Re.REQUESTED_TOKEN_USE,encodeURIComponent(e))},e.prototype.addGrantType=function(e){this.parameters.set(Re.GRANT_TYPE,encodeURIComponent(e))},e.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},e.prototype.addExtraQueryParameters=function(e){var t=this;Fr.sanitizeEQParams(e,this.parameters),Object.keys(e).forEach((function(r){t.parameters.set(r,e[r])}))},e.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(e)try{r=JSON.parse(e)}catch(e){throw Cr.createInvalidClaimsRequestError()}else r={};return t&&t.length>0&&(r.hasOwnProperty(Oe.ACCESS_TOKEN)||(r[Oe.ACCESS_TOKEN]={}),r[Oe.ACCESS_TOKEN][Oe.XMS_CC]={values:t}),JSON.stringify(r)},e.prototype.addUsername=function(e){this.parameters.set(Qe.username,e)},e.prototype.addPassword=function(e){this.parameters.set(Qe.password,e)},e.prototype.addPopToken=function(e){Xt.isEmpty(e)||(this.parameters.set(Re.TOKEN_TYPE,Ye.POP),this.parameters.set(Re.REQ_CNF,encodeURIComponent(e)))},e.prototype.addServerTelemetry=function(e){this.parameters.set(Re.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(Re.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},e.prototype.addThrottling=function(){this.parameters.set(Re.X_MS_LIB_CAPABILITY,ot)},e.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach((function(t,r){e.push(r+"="+t)})),e.join("&")},e}(),Kr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ce(t,e),t.createIdTokenEntity=function(e,r,n,o,i,a){var s=new t;return s.credentialType=Fe.ID_TOKEN,s.homeAccountId=e,s.environment=r,s.clientId=o,s.secret=n,s.realm=i,s.oboAssertion=a,s},t.isIdTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===Fe.ID_TOKEN)},t}(rr),Gr=function(){function e(){}return e.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},e.isTokenExpired=function(t,r){var n=Number(t)||0;return e.nowSeconds()+r>n},e.wasClockTurnedBack=function(t){return Number(t)>e.nowSeconds()},e.delay=function(e,t){return new Promise((function(r){return setTimeout((function(){return r(t)}),e)}))},e}(),Br=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ce(t,e),t.createAccessTokenEntity=function(e,r,n,o,i,a,s,c,u,l,d,h){var p,f=new t;f.homeAccountId=e,f.credentialType=Fe.ACCESS_TOKEN,f.secret=n;var g=Gr.nowSeconds();if(f.cachedAt=g.toString(),f.expiresOn=s.toString(),f.extendedExpiresOn=c.toString(),l&&(f.refreshOn=l.toString()),f.environment=r,f.clientId=o,f.realm=i,f.target=a,f.oboAssertion=h,f.tokenType=Xt.isEmpty(d)?Ye.BEARER:d,f.tokenType===Ye.POP){f.credentialType=Fe.ACCESS_TOKEN_WITH_AUTH_SCHEME;var y=_r.extractTokenClaims(n,u);if(!(null===(p=null==y?void 0:y.cnf)||void 0===p?void 0:p.kid))throw Jt.createTokenClaimsRequiredError();f.keyId=y.cnf.kid}return f},t.isAccessTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&(e.credentialType===Fe.ACCESS_TOKEN||e.credentialType===Fe.ACCESS_TOKEN_WITH_AUTH_SCHEME))},t}(rr),jr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ce(t,e),t.createRefreshTokenEntity=function(e,r,n,o,i,a){var s=new t;return s.clientId=o,s.credentialType=Fe.REFRESH_TOKEN,s.environment=r,s.homeAccountId=e,s.secret=n,s.oboAssertion=a,i&&(s.familyId=i),s},t.isRefreshTokenEntity=function(e){return!!e&&(e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===Fe.REFRESH_TOKEN)},t}(rr),zr=["interaction_required","consent_required","login_required"],Wr=["message_only","additional_action","basic_action","user_password_expired","consent_required"],$r={code:"no_tokens_found",desc:"No refresh token found in the cache. Please sign-in."},Yr=function(e){function t(r,n,o){var i=e.call(this,r,n,o)||this;return i.name="InteractionRequiredAuthError",Object.setPrototypeOf(i,t.prototype),i}return Ce(t,e),t.isInteractionRequiredError=function(e,t,r){var n=!!e&&zr.indexOf(e)>-1,o=!!r&&Wr.indexOf(r)>-1,i=!!t&&zr.some((function(e){return t.indexOf(e)>-1}));return n||i||o},t.createNoTokensFoundError=function(){return new t($r.code,$r.desc)},t}(ut),Vr=function(e,t,r,n,o){this.account=e||null,this.idToken=t||null,this.accessToken=r||null,this.refreshToken=n||null,this.appMetadata=o||null},Qr=function(){function e(){}return e.setRequestState=function(t,r,n){var o=e.generateLibraryState(t,n);return Xt.isEmpty(r)?o:""+o+ke.RESOURCE_DELIM+r},e.generateLibraryState=function(e,t){if(!e)throw Jt.createNoCryptoObjectError("generateLibraryState");var r={id:e.createNewGuid()};t&&(r.meta=t);var n=JSON.stringify(r);return e.base64Encode(n)},e.parseRequestState=function(e,t){if(!e)throw Jt.createNoCryptoObjectError("parseRequestState");if(Xt.isEmpty(t))throw Jt.createInvalidStateError(t,"Null, undefined or empty state");try{var r=t.split(ke.RESOURCE_DELIM),n=r[0],o=r.length>1?r.slice(1).join(ke.RESOURCE_DELIM):"",i=e.base64Decode(n),a=JSON.parse(i);return{userRequestState:Xt.isEmpty(o)?"":o,libraryState:a}}catch(e){throw Jt.createInvalidStateError(t,e)}},e}(),Jr=function(){function e(t){if(this._urlString=t,Xt.isEmpty(this._urlString))throw Cr.createUrlEmptyError();Xt.isEmpty(this.getHash())&&(this._urlString=e.canonicalizeUri(t))}return Object.defineProperty(e.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),e.canonicalizeUri=function(e){if(e){var t=e.toLowerCase();return Xt.endsWith(t,"?")?t=t.slice(0,-1):Xt.endsWith(t,"?/")&&(t=t.slice(0,-2)),Xt.endsWith(t,"/")||(t+="/"),t}return e},e.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(e){throw Cr.createUrlParseError(e)}if(!e.HostNameAndPort||!e.PathSegments)throw Cr.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw Cr.createInsecureAuthorityUriError(this.urlString)},e.appendQueryString=function(e,t){return Xt.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},e.removeHashFromUrl=function(t){return e.canonicalizeUri(t.split("#")[0])},e.prototype.replaceTenantPath=function(t){var r=this.getUrlComponents(),n=r.PathSegments;return!t||0===n.length||n[0]!==be.COMMON&&n[0]!==be.ORGANIZATIONS||(n[0]=t),e.constructAuthorityUriFromObject(r)},e.prototype.getHash=function(){return e.parseHash(this.urlString)},e.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Cr.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},n=r.AbsolutePath.split("/");return n=n.filter((function(e){return e&&e.length>0})),r.PathSegments=n,!Xt.isEmpty(r.QueryString)&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r},e.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw Cr.createUrlParseError("Given url string: "+e);return r[2]},e.getAbsoluteUrl=function(t,r){if(t[0]===ke.FORWARD_SLASH){var n=new e(r).getUrlComponents();return n.Protocol+"//"+n.HostNameAndPort+t}return t},e.parseHash=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):""},e.constructAuthorityUriFromObject=function(t){return new e(t.Protocol+"//"+t.HostNameAndPort+"/"+t.PathSegments.join("/"))},e.getDeserializedHash=function(t){if(Xt.isEmpty(t))return{};var r=e.parseHash(t),n=Xt.queryStringToObject(Xt.isEmpty(r)?t:r);if(!n)throw Jt.createHashNotDeserializedError(JSON.stringify(n));return n},e.hashContainsKnownProperties=function(t){if(Xt.isEmpty(t)||t.indexOf("=")<0)return!1;var r=e.getDeserializedHash(t);return!!(r.code||r.error_description||r.error||r.state)},e}();
/*! @azure/msal-common v5.0.1 2021-10-05 */!function(e){e.SW="sw",e.UHW="uhw"}(Dr||(Dr={}));var Xr,Zr=function(){function e(e){this.cryptoUtils=e}return e.prototype.generateCnf=function(e){return Te(this,void 0,void 0,(function(){var t;return Se(this,(function(r){switch(r.label){case 0:return[4,this.generateKid(e)];case 1:return t=r.sent(),[2,this.cryptoUtils.base64Encode(JSON.stringify(t))]}}))}))},e.prototype.generateKid=function(e){return Te(this,void 0,void 0,(function(){return Se(this,(function(t){switch(t.label){case 0:return[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return[2,{kid:t.sent(),xms_ksl:Dr.SW}]}}))}))},e.prototype.signPopToken=function(e,t){var r;return Te(this,void 0,void 0,(function(){var n;return Se(this,(function(o){if(n=_r.extractTokenClaims(e,this.cryptoUtils),!(null===(r=null==n?void 0:n.cnf)||void 0===r?void 0:r.kid))throw Jt.createTokenClaimsRequiredError();return[2,this.signPayload(e,n.cnf.kid,t)]}))}))},e.prototype.signPayload=function(e,t,r,n){return Te(this,void 0,void 0,(function(){var o,i,a,s,c;return Se(this,(function(u){switch(u.label){case 0:return o=r.resourceRequestMethod,i=r.resourceRequestUri,a=r.shrClaims,s=i?new Jr(i):void 0,c=null==s?void 0:s.getUrlComponents(),[4,this.cryptoUtils.signJwt(we({at:e,ts:Gr.nowSeconds(),m:null==o?void 0:o.toUpperCase(),u:null==c?void 0:c.HostNameAndPort,nonce:this.cryptoUtils.createNewGuid(),p:null==c?void 0:c.AbsolutePath,q:(null==c?void 0:c.QueryString)?[[],c.QueryString]:void 0,client_claims:a||void 0},n),t)];case 1:return[2,u.sent()]}}))}))},e}(),en=function(){function e(){}return e.prototype.generateAppMetadataKey=function(){return e.generateAppMetadataCacheKey(this.environment,this.clientId)},e.generateAppMetadataCacheKey=function(e,t){return[je,e,t].join(qe.CACHE_KEY_SEPARATOR).toLowerCase()},e.createAppMetadataEntity=function(t,r,n){var o=new e;return o.clientId=t,o.environment=r,n&&(o.familyId=n),o},e.isAppMetadataEntity=function(e,t){return!!t&&(0===e.indexOf(je)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment"))},e}(),tn=function(){function e(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(e.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),e}(),rn=function(){function e(e,t,r,n,o,i){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n,this.serializableCache=o,this.persistencePlugin=i}return e.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(!e.state||!t)throw e.state?Jt.createStateNotFoundError("Cached State"):Jt.createStateNotFoundError("Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw Jt.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(Yr.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Yr(e.error||ke.EMPTY_STRING,e.error_description,e.suberror);throw new Mr(e.error||ke.EMPTY_STRING,e.error_description,e.suberror)}e.client_info&&Tr(e.client_info,r)},e.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(Yr.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new Yr(e.error,e.error_description,e.suberror);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new Mr(e.error,t,e.suberror)}},e.prototype.handleServerTokenResponse=function(t,r,n,o,i,a,s){return Te(this,void 0,void 0,(function(){var c,u,l,d,h;return Se(this,(function(p){switch(p.label){case 0:if(t.id_token&&(c=new _r(t.id_token||ke.EMPTY_STRING,this.cryptoObj),i&&!Xt.isEmpty(i.nonce)&&c.claims.nonce!==i.nonce))throw Jt.createNonceMismatchError();this.homeAccountIdentifier=Ar.generateHomeAccountId(t.client_info||ke.EMPTY_STRING,r.authorityType,this.logger,this.cryptoObj,c),i&&i.state&&(u=Qr.parseRequestState(this.cryptoObj,i.state)),l=this.generateCacheRecord(t,r,n,c,o.scopes,a,i),p.label=1;case 1:return p.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),d=new tn(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(d)]):[3,3];case 2:p.sent(),p.label=3;case 3:return!s||!l.account||(h=l.account.generateAccountKey(),this.cacheStorage.getAccount(h))?[4,this.cacheStorage.saveCacheRecord(l)]:(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,e.generateAuthenticationResult(this.cryptoObj,r,l,!1,o,c,u)]);case 4:return p.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&d?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(d)]):[3,7];case 6:p.sent(),p.label=7;case 7:return[7];case 8:return[2,e.generateAuthenticationResult(this.cryptoObj,r,l,!1,o,c,u)]}}))}))},e.prototype.generateCacheRecord=function(e,t,r,n,o,i,a){var s,c,u=t.getPreferredCache();if(Xt.isEmpty(u))throw Jt.createInvalidCacheEnvironmentError();!Xt.isEmpty(e.id_token)&&n&&(s=Kr.createIdTokenEntity(this.homeAccountIdentifier,u,e.id_token||ke.EMPTY_STRING,this.clientId,n.claims.tid||ke.EMPTY_STRING,i),c=this.generateAccountEntity(e,n,t,i,a));var l=null;if(!Xt.isEmpty(e.access_token)){var d=e.scope?wr.fromString(e.scope):new wr(o||[]),h=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,p=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,f=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,g=r+h,y=g+p,m=f&&f>0?r+f:void 0;l=Br.createAccessTokenEntity(this.homeAccountIdentifier,u,e.access_token||ke.EMPTY_STRING,this.clientId,n?n.claims.tid||ke.EMPTY_STRING:t.tenant,d.printScopes(),g,y,this.cryptoObj,m,e.token_type,i)}var v=null;Xt.isEmpty(e.refresh_token)||(v=jr.createRefreshTokenEntity(this.homeAccountIdentifier,u,e.refresh_token||ke.EMPTY_STRING,this.clientId,e.foci,i));var E=null;return Xt.isEmpty(e.foci)||(E=en.createAppMetadataEntity(this.clientId,u,e.foci)),new Vr(c,s,l,v,E)},e.prototype.generateAccountEntity=function(e,t,r,n,o){var i=r.authorityType,a=o?o.cloud_graph_host_name:"",s=o?o.msgraph_host:"";if(i===Zt.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),Ar.createGenericAccount(this.homeAccountIdentifier,t,r,n,a,s);if(Xt.isEmpty(e.client_info)&&"AAD"===r.protocolMode)throw Jt.createClientInfoEmptyError();return e.client_info?Ar.createAccount(e.client_info,this.homeAccountIdentifier,t,r,n,a,s):Ar.createGenericAccount(this.homeAccountIdentifier,t,r,n,a,s)},e.generateAuthenticationResult=function(e,t,r,n,o,i,a){var s,c,u;return Te(this,void 0,void 0,(function(){var l,d,h,p,f,g,y;return Se(this,(function(m){switch(m.label){case 0:return l="",d=[],h=null,f=ke.EMPTY_STRING,r.accessToken?r.accessToken.tokenType!==Ye.POP?[3,2]:[4,new Zr(e).signPopToken(r.accessToken.secret,o)]:[3,4];case 1:return l=m.sent(),[3,3];case 2:l=r.accessToken.secret,m.label=3;case 3:d=wr.fromString(r.accessToken.target).asArray(),h=new Date(1e3*Number(r.accessToken.expiresOn)),p=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),m.label=4;case 4:return r.appMetadata&&(f=r.appMetadata.familyId===ze?ze:ke.EMPTY_STRING),g=(null==i?void 0:i.claims.oid)||(null==i?void 0:i.claims.sub)||ke.EMPTY_STRING,y=(null==i?void 0:i.claims.tid)||ke.EMPTY_STRING,[2,{authority:t.canonicalAuthority,uniqueId:g,tenantId:y,scopes:d,account:r.account?r.account.getAccountInfo():null,idToken:i?i.rawToken:ke.EMPTY_STRING,idTokenClaims:i?i.claims:{},accessToken:l,fromCache:n,expiresOn:h,correlationId:o.correlationId,extExpiresOn:p,familyId:f,tokenType:(null===(s=r.accessToken)||void 0===s?void 0:s.tokenType)||ke.EMPTY_STRING,state:a?a.userRequestState:ke.EMPTY_STRING,cloudGraphHostName:(null===(c=r.account)||void 0===c?void 0:c.cloudGraphHostName)||ke.EMPTY_STRING,msGraphHost:(null===(u=r.account)||void 0===u?void 0:u.msGraphHost)||ke.EMPTY_STRING}]}}))}))},e}(),nn=function(e){function t(t){return e.call(this,t)||this}return Ce(t,e),t.prototype.getAuthCodeUrl=function(e){return Te(this,void 0,void 0,(function(){var t;return Se(this,(function(r){return t=this.createAuthCodeUrlQueryString(e),[2,Jr.appendQueryString(this.authority.authorizationEndpoint,t)]}))}))},t.prototype.acquireToken=function(e,t){return Te(this,void 0,void 0,(function(){var r,n,o;return Se(this,(function(i){switch(i.label){case 0:if(this.logger.info("in acquireToken call"),!e||Xt.isEmpty(e.code))throw Jt.createTokenRequestCannotBeMadeError();return r=Gr.nowSeconds(),[4,this.executeTokenRequest(this.authority,e)];case 1:return n=i.sent(),(o=new rn(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(n.body),[4,o.handleServerTokenResponse(n.body,this.authority,r,e,t)];case 2:return[2,i.sent()]}}))}))},t.prototype.handleFragmentResponse=function(e,t){var r=new rn(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),n=new Jr(e),o=Jr.getDeserializedHash(n.getHash());if(r.validateServerAuthorizationCodeResponse(o,t,this.cryptoUtils),!o.code)throw Jt.createNoAuthCodeInServerResponseError();return we(we({},o),{code:o.code})},t.prototype.getLogoutUri=function(e){if(!e)throw Cr.createEmptyLogoutRequestError();var t=this.createLogoutUrlQueryString(e);return Jr.appendQueryString(this.authority.endSessionEndpoint,t)},t.prototype.executeTokenRequest=function(e,t){return Te(this,void 0,void 0,(function(){var r,n,o,i,a,s,c;return Se(this,(function(u){switch(u.label){case 0:return r={clientId:this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims},[4,this.createTokenRequestBody(t)];case 1:if(n=u.sent(),o=this.createTokenQueryParameters(t),i=void 0,t.clientInfo)try{a=Tr(t.clientInfo,this.cryptoUtils),i={credential:""+a.uid+qe.CLIENT_INFO_SEPARATOR+a.utid,type:Ur.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}return s=this.createTokenRequestHeaders(i||t.ccsCredential),c=Xt.isEmpty(o)?e.tokenEndpoint:e.tokenEndpoint+"?"+o,[2,this.executePostToTokenEndpoint(c,n,s,r)]}}))}))},t.prototype.createTokenQueryParameters=function(e){var t=new xr;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},t.prototype.createTokenRequestBody=function(e){return Te(this,void 0,void 0,(function(){var t,r,n,o,i,a;return Se(this,(function(s){switch(s.label){case 0:return(t=new xr).addClientId(this.config.authOptions.clientId),t.addRedirectUri(e.redirectUri),t.addScopes(e.scopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addThrottling(),this.serverTelemetryManager&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(r=this.config.clientCredentials.clientAssertion,t.addClientAssertion(r.assertion),t.addClientAssertionType(r.assertionType)),t.addGrantType(He.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),e.authenticationScheme!==Ye.POP?[3,2]:[4,new Zr(this.cryptoUtils).generateCnf(e)];case 1:n=s.sent(),t.addPopToken(n),s.label=2;case 2:if(o=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(o),(!Xt.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),i=void 0,e.clientInfo)try{a=Tr(e.clientInfo,this.cryptoUtils),i={credential:""+a.uid+qe.CLIENT_INFO_SEPARATOR+a.utid,type:Ur.HOME_ACCOUNT_ID}}catch(e){this.logger.verbose("Could not parse client info for CCS Header: "+e)}else i=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&i)switch(i.type){case Ur.HOME_ACCOUNT_ID:try{a=Sr(i.credential),t.addCcsOid(a)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Ur.UPN:t.addCcsUpn(i.credential)}return[2,t.createQueryString()]}}))}))},t.prototype.createAuthCodeUrlQueryString=function(e){var t=new xr;t.addClientId(this.config.authOptions.clientId);var r=Ae(e.scopes||[],e.extraScopesToConsent||[]);t.addScopes(r),t.addRedirectUri(e.redirectUri);var n=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(n),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),t.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.domainHint&&t.addDomainHint(e.domainHint),e.prompt!==Me.SELECT_ACCOUNT)if(e.sid&&e.prompt===Me.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),t.addSid(e.sid);else if(e.account){var o=this.extractAccountSid(e.account);if(o&&e.prompt===Me.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),t.addSid(o);try{var i=Sr(e.account.homeAccountId);t.addCcsOid(i)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),t.addLoginHint(e.account.username);try{i=Sr(e.account.homeAccountId);t.addCcsOid(i)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(!Xt.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},t.prototype.createLogoutUrlQueryString=function(e){var t=new xr;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},t.prototype.extractAccountSid=function(e){return e.idTokenClaims&&e.idTokenClaims.sid||null},t}(qr),on=function(e){function t(t){return e.call(this,t)||this}return Ce(t,e),t.prototype.acquireToken=function(e){return Te(this,void 0,void 0,(function(){var t,r,n;return Se(this,(function(o){switch(o.label){case 0:return t=Gr.nowSeconds(),[4,this.executeTokenRequest(e,this.authority)];case 1:return r=o.sent(),(n=new rn(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(r.body),[2,n.handleServerTokenResponse(r.body,this.authority,t,e,void 0,void 0,!0)]}}))}))},t.prototype.acquireTokenByRefreshToken=function(e){return Te(this,void 0,void 0,(function(){var t,r;return Se(this,(function(n){if(!e)throw Cr.createEmptyTokenRequestError();if(!e.account)throw Jt.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(e.account.environment,this.config.authOptions.clientId))try{return[2,this.acquireTokenWithCachedRefreshToken(e,!0)]}catch(n){if(t=n instanceof Yr&&n.errorCode===$r.code,r=n instanceof Mr&&n.errorCode===it&&n.subError===at,t||r)return[2,this.acquireTokenWithCachedRefreshToken(e,!1)];throw n}return[2,this.acquireTokenWithCachedRefreshToken(e,!1)]}))}))},t.prototype.acquireTokenWithCachedRefreshToken=function(e,t){return Te(this,void 0,void 0,(function(){var r,n;return Se(this,(function(o){if(!(r=this.cacheManager.readRefreshTokenFromCache(this.config.authOptions.clientId,e.account,t)))throw Yr.createNoTokensFoundError();return n=we(we({},e),{refreshToken:r.secret,authenticationScheme:e.authenticationScheme||Ye.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Ur.HOME_ACCOUNT_ID}}),[2,this.acquireToken(n)]}))}))},t.prototype.executeTokenRequest=function(e,t){return Te(this,void 0,void 0,(function(){var r,n,o,i,a;return Se(this,(function(s){switch(s.label){case 0:return[4,this.createTokenRequestBody(e)];case 1:return r=s.sent(),n=this.createTokenQueryParameters(e),o=this.createTokenRequestHeaders(e.ccsCredential),i={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims},a=Jr.appendQueryString(t.tokenEndpoint,n),[2,this.executePostToTokenEndpoint(a,r,o,i)]}}))}))},t.prototype.createTokenQueryParameters=function(e){var t=new xr;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()},t.prototype.createTokenRequestBody=function(e){return Te(this,void 0,void 0,(function(){var t,r,n,o,i,a,s;return Se(this,(function(c){switch(c.label){case 0:return(t=new xr).addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes),t.addGrantType(He.REFRESH_TOKEN_GRANT),t.addClientInfo(),t.addLibraryInfo(this.config.libraryInfo),t.addThrottling(),this.serverTelemetryManager&&t.addServerTelemetry(this.serverTelemetryManager),r=e.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(r),t.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(n=this.config.clientCredentials.clientAssertion,t.addClientAssertion(n.assertion),t.addClientAssertionType(n.assertionType)),e.authenticationScheme!==Ye.POP?[3,2]:(o=new Zr(this.cryptoUtils),a=(i=t).addPopToken,[4,o.generateCnf(e)]);case 1:a.apply(i,[c.sent()]),c.label=2;case 2:if((!Xt.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Ur.HOME_ACCOUNT_ID:try{s=Sr(e.ccsCredential.credential),t.addCcsOid(s)}catch(e){this.logger.verbose("Could not parse home account ID for CCS Header: "+e)}break;case Ur.UPN:t.addCcsUpn(e.ccsCredential.credential)}return[2,t.createQueryString()]}}))}))},t}(qr),an=function(e){function t(t){return e.call(this,t)||this}return Ce(t,e),t.prototype.acquireToken=function(e){return Te(this,void 0,void 0,(function(){var t;return Se(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.acquireCachedToken(e)];case 1:return[2,r.sent()];case 2:if((t=r.sent())instanceof Jt&&t.errorCode===Wt.code)return[2,new on(this.config).acquireTokenByRefreshToken(e)];throw t;case 3:return[2]}}))}))},t.prototype.acquireCachedToken=function(e){var t,r,n,o;return Te(this,void 0,void 0,(function(){var i,a,s,c;return Se(this,(function(u){switch(u.label){case 0:if(!e)throw Cr.createEmptyTokenRequestError();if(!e.account)throw Jt.createNoAccountInSilentRequestError();if(i=new wr(e.scopes||[]),a=e.authority||this.authority.getPreferredCache(),s=e.authenticationScheme||Ye.BEARER,c=this.cacheManager.readCacheRecord(e.account,this.config.authOptions.clientId,i,a,s),e.forceRefresh)throw null===(t=this.serverTelemetryManager)||void 0===t||t.setCacheOutcome(et.FORCE_REFRESH),Jt.createRefreshRequiredError();if(!c.accessToken)throw null===(r=this.serverTelemetryManager)||void 0===r||r.setCacheOutcome(et.NO_CACHED_ACCESS_TOKEN),Jt.createRefreshRequiredError();if(Gr.wasClockTurnedBack(c.accessToken.cachedAt)||Gr.isTokenExpired(c.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw null===(n=this.serverTelemetryManager)||void 0===n||n.setCacheOutcome(et.CACHED_ACCESS_TOKEN_EXPIRED),Jt.createRefreshRequiredError();if(c.accessToken.refreshOn&&Gr.isTokenExpired(c.accessToken.refreshOn,0))throw null===(o=this.serverTelemetryManager)||void 0===o||o.setCacheOutcome(et.REFRESH_CACHED_ACCESS_TOKEN),Jt.createRefreshRequiredError();if(!Xt.isEmptyObj(e.claims))throw Jt.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(c,e)];case 1:return[2,u.sent()]}}))}))},t.prototype.generateResultFromCacheRecord=function(e,t){return Te(this,void 0,void 0,(function(){var r;return Se(this,(function(n){switch(n.label){case 0:return e.idToken&&(r=new _r(e.idToken.secret,this.config.cryptoInterface)),[4,rn.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)];case 1:return[2,n.sent()]}}))}))},t}(qr);
/*! @azure/msal-common v5.0.1 2021-10-05 */
/*! @azure/msal-common v5.0.1 2021-10-05 */
function sn(e){return e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("end_session_endpoint")&&e.hasOwnProperty("issuer")}
/*! @azure/msal-common v5.0.1 2021-10-05 */!function(e){e.AAD="AAD",e.OIDC="OIDC"}(Xr||(Xr={}));
/*! @azure/msal-common v5.0.1 2021-10-05 */
var cn=function(){function e(){this.expiresAt=Gr.nowSeconds()+$e}return e.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},e.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t},e.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},e.prototype.resetExpiresAt=function(){this.expiresAt=Gr.nowSeconds()+$e},e.prototype.isExpired=function(){return this.expiresAt<=Gr.nowSeconds()},e.isAuthorityMetadataEntity=function(e,t){return!!t&&(0===e.indexOf(We)&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("end_session_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt"))},e}();
/*! @azure/msal-common v5.0.1 2021-10-05 */
/*! @azure/msal-common v5.0.1 2021-10-05 */
var un,ln,dn,hn,pn,fn,gn,yn=function(){function e(e){this.networkInterface=e}return e.prototype.detectRegion=function(e,t){return Te(this,void 0,void 0,(function(){var r,n,o,i;return Se(this,(function(a){switch(a.label){case 0:if(r=e)return[3,8];a.label=1;case 1:return a.trys.push([1,6,,7]),[4,this.getRegionFromIMDS(ke.IMDS_VERSION)];case 2:return(n=a.sent()).status===Je.httpSuccess&&(r=n.body,t.region_source=Xe.IMDS),n.status!==Je.httpBadRequest?[3,5]:[4,this.getCurrentVersion()];case 3:return(o=a.sent())?[4,this.getRegionFromIMDS(o)]:(t.region_source=Xe.FAILED_AUTO_DETECTION,[2,null]);case 4:(i=a.sent()).status===Je.httpSuccess&&(r=i.body,t.region_source=Xe.IMDS),a.label=5;case 5:return[3,7];case 6:return a.sent(),t.region_source=Xe.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:t.region_source=Xe.ENVIRONMENT_VARIABLE,a.label=9;case 9:return r||(t.region_source=Xe.FAILED_AUTO_DETECTION),[2,r||null]}}))}))},e.prototype.getRegionFromIMDS=function(t){return Te(this,void 0,void 0,(function(){return Se(this,(function(r){return[2,this.networkInterface.sendGetRequestAsync(ke.IMDS_ENDPOINT+"?api-version="+t+"&format=text",e.IMDS_OPTIONS,ke.IMDS_TIMEOUT)]}))}))},e.prototype.getCurrentVersion=function(){return Te(this,void 0,void 0,(function(){var t;return Se(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.networkInterface.sendGetRequestAsync(ke.IMDS_ENDPOINT+"?format=json",e.IMDS_OPTIONS)];case 1:return(t=r.sent()).status===Je.httpBadRequest&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?[2,t.body["newest-versions"][0]]:[2,null];case 2:return r.sent(),[2,null];case 3:return[2]}}))}))},e.IMDS_OPTIONS={headers:{Metadata:"true"}},e}(),mn=function(){function e(e,t,r,n){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=n,this.regionDiscovery=new yn(t),this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0}}return Object.defineProperty(e.prototype,"authorityType",{get:function(){var e=this.canonicalAuthorityUrlComponents.PathSegments;return e.length&&e[0].toLowerCase()===ke.ADFS?Zt.Adfs:Zt.Default},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new Jr(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(e)}throw Jt.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(e)}throw Jt.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(e)}throw Jt.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(e)}throw Jt.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.issuer);return this.replaceTenant(e)}throw Jt.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),e.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},e.prototype.replacePath=function(e){var t=e,r=new Jr(this.metadata.canonical_authority).getUrlComponents().PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((function(e,n){var o=r[n];e!==o&&(t=t.replace("/"+o+"/","/"+e+"/"))})),t},Object.defineProperty(e.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===Zt.Adfs||this.protocolMode===Xr.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),e.prototype.discoveryComplete=function(){return!!this.metadata},e.prototype.resolveEndpointsAsync=function(){return Te(this,void 0,void 0,(function(){var e,t,r,n;return Se(this,(function(o){switch(o.label){case 0:return(e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(e=new cn).updateCanonicalAuthority(this.canonicalAuthority),[4,this.updateCloudDiscoveryMetadata(e)];case 1:return t=o.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network),[4,this.updateEndpointMetadata(e)];case 2:return r=o.sent(),t!==Be.CACHE&&r!==Be.CACHE&&(e.resetExpiresAt(),e.updateCanonicalAuthority(this.canonicalAuthority)),n=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache),this.cacheManager.setAuthorityMetadata(n,e),this.metadata=e,[2]}}))}))},e.prototype.updateEndpointMetadata=function(t){var r;return Te(this,void 0,void 0,(function(){var n,o,i;return Se(this,(function(a){switch(a.label){case 0:return(n=this.getEndpointMetadataFromConfig())?(t.updateEndpointMetadata(n,!1),[2,Be.CONFIG]):this.isAuthoritySameType(t)&&t.endpointsFromNetwork&&!t.isExpired()?[2,Be.CACHE]:[4,this.getEndpointMetadataFromNetwork()];case 1:return(n=a.sent())?(null===(r=this.authorityOptions.azureRegionConfiguration)||void 0===r?void 0:r.azureRegion)?[4,this.regionDiscovery.detectRegion(this.authorityOptions.azureRegionConfiguration.environmentRegion,this.regionDiscoveryMetadata)]:[3,3]:[3,4];case 2:o=a.sent(),i=this.authorityOptions.azureRegionConfiguration.azureRegion===ke.AZURE_REGION_AUTO_DISCOVER_FLAG?o:this.authorityOptions.azureRegionConfiguration.azureRegion,this.authorityOptions.azureRegionConfiguration.azureRegion===ke.AZURE_REGION_AUTO_DISCOVER_FLAG?this.regionDiscoveryMetadata.region_outcome=o?Ze.AUTO_DETECTION_REQUESTED_SUCCESSFUL:Ze.AUTO_DETECTION_REQUESTED_FAILED:this.regionDiscoveryMetadata.region_outcome=o?this.authorityOptions.azureRegionConfiguration.azureRegion===o?Ze.CONFIGURED_MATCHES_DETECTED:Ze.CONFIGURED_NOT_DETECTED:Ze.CONFIGURED_NO_AUTO_DETECTION,i&&(this.regionDiscoveryMetadata.region_used=i,n=e.replaceWithRegionalInformation(n,i)),a.label=3;case 3:return t.updateEndpointMetadata(n,!0),[2,Be.NETWORK];case 4:throw Jt.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}}))}))},e.prototype.isAuthoritySameType=function(e){return new Jr(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},e.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw Cr.createInvalidAuthorityMetadataError()}return null},e.prototype.getEndpointMetadataFromNetwork=function(){return Te(this,void 0,void 0,(function(){var e;return Se(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint)];case 1:return[2,sn((e=t.sent()).body)?e.body:null];case 2:return t.sent(),[2,null];case 3:return[2]}}))}))},e.prototype.updateCloudDiscoveryMetadata=function(e){return Te(this,void 0,void 0,(function(){var t;return Se(this,(function(r){switch(r.label){case 0:return(t=this.getCloudDiscoveryMetadataFromConfig())?(e.updateCloudDiscoveryMetadata(t,!1),[2,Be.CONFIG]):this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!e.isExpired()?[2,Be.CACHE]:[4,this.getCloudDiscoveryMetadataFromNetwork()];case 1:if(t=r.sent())return e.updateCloudDiscoveryMetadata(t,!0),[2,Be.NETWORK];throw Cr.createUntrustedAuthorityError()}}))}))},e.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityOptions.cloudDiscoveryMetadata)try{var t=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),r=e.getCloudDiscoveryMetadataFromNetworkResponse(t.metadata,this.hostnameAndPort);if(r)return r}catch(e){throw Cr.createInvalidCloudDiscoveryMetadataError()}return this.isInKnownAuthorities()?e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort):null},e.prototype.getCloudDiscoveryMetadataFromNetwork=function(){return Te(this,void 0,void 0,(function(){var t,r,n,o;return Se(this,(function(i){switch(i.label){case 0:t=""+ke.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",r=null,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(t)];case 2:return n=i.sent(),o=function(e){return e.hasOwnProperty("tenant_discovery_endpoint")&&e.hasOwnProperty("metadata")}(n.body)?n.body.metadata:[],0===o.length?[2,null]:(r=e.getCloudDiscoveryMetadataFromNetworkResponse(o,this.hostnameAndPort),[3,4]);case 3:return i.sent(),[2,null];case 4:return r||(r=e.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,r]}}))}))},e.prototype.isInKnownAuthorities=function(){var e=this;return this.authorityOptions.knownAuthorities.filter((function(t){return Jr.getDomainFromUrl(t).toLowerCase()===e.hostnameAndPort})).length>0},e.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},e.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.aliases.indexOf(t)>-1)return n}return null},e.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw Jt.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},e.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},e.isPublicCloudAuthority=function(e){return ke.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0},e.buildRegionalAuthorityString=function(e,t,r){var n=new Jr(e);n.validateAsUri();var o=n.getUrlComponents(),i=t+"."+o.HostNameAndPort;this.isPublicCloudAuthority(o.HostNameAndPort)&&(i=t+"."+ke.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var a=Jr.constructAuthorityUriFromObject(we(we({},n.getUrlComponents()),{HostNameAndPort:i})).urlString;return r?a+"?"+r:a},e.replaceWithRegionalInformation=function(t,r){return t.authorization_endpoint=e.buildRegionalAuthorityString(t.authorization_endpoint,r),t.token_endpoint=e.buildRegionalAuthorityString(t.token_endpoint,r,"allowestsrnonmsi=true"),t.end_session_endpoint=e.buildRegionalAuthorityString(t.end_session_endpoint,r),t},e}(),vn=function(){function e(){}return e.createDiscoveredInstance=function(t,r,n,o){return Te(this,void 0,void 0,(function(){var i,a;return Se(this,(function(s){switch(s.label){case 0:i=e.createInstance(t,r,n,o),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,i.resolveEndpointsAsync()];case 2:return s.sent(),[2,i];case 3:throw a=s.sent(),Jt.createEndpointDiscoveryIncompleteError(a);case 4:return[2]}}))}))},e.createInstance=function(e,t,r,n){if(Xt.isEmpty(e))throw Cr.createUrlEmptyError();return new mn(e,t,r,n)},e}(),En=function(){function e(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return e.isServerTelemetryEntity=function(e,t){var r=0===e.indexOf(Ve.CACHE_KEY),n=!0;return t&&(n=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&n},e}(),Cn=function(){function e(){}return e.isThrottlingEntity=function(e,t){var r=!1;e&&(r=0===e.indexOf(nt));var n=!0;return t&&(n=t.hasOwnProperty("throttleTime")),r&&n},e}(),wn={sendGetRequestAsync:function(){return Promise.reject(ut.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(ut.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},Tn=function(){function e(e,t){this.cacheOutcome=et.NO_CACHE_HIT,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||ke.EMPTY_STRING,this.wrapperVer=e.wrapperVer||ke.EMPTY_STRING,this.telemetryCacheKey=Ve.CACHE_KEY+qe.CACHE_KEY_SEPARATOR+e.clientId}return e.prototype.generateCurrentRequestHeaderValue=function(){var e=""+this.apiId+Ve.VALUE_SEPARATOR+this.cacheOutcome,t=[this.wrapperSKU,this.wrapperVer].join(Ve.VALUE_SEPARATOR),r=[e,this.getRegionDiscoveryFields()].join(Ve.VALUE_SEPARATOR);return[Ve.SCHEMA_VERSION,r,t].join(Ve.CATEGORY_SEPARATOR)},e.prototype.generateLastRequestHeaderValue=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t),n=t.failedRequests.slice(0,2*r).join(Ve.VALUE_SEPARATOR),o=t.errors.slice(0,r).join(Ve.VALUE_SEPARATOR),i=t.errors.length,a=[i,r<i?Ve.OVERFLOW_TRUE:Ve.OVERFLOW_FALSE].join(Ve.VALUE_SEPARATOR);return[Ve.SCHEMA_VERSION,t.cacheHits,n,o,a].join(Ve.CATEGORY_SEPARATOR)},e.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=Ve.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),Xt.isEmpty(e.subError)?Xt.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(Ve.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},e.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},e.prototype.getLastRequests=function(){var e=new En;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},e.prototype.clearTelemetryCache=function(){var t=this.getLastRequests(),r=e.maxErrorsToSend(t);if(r===t.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var n=new En;n.failedRequests=t.failedRequests.slice(2*r),n.errors=t.errors.slice(r),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,n)}},e.maxErrorsToSend=function(e){var t,r=0,n=0,o=e.errors.length;for(t=0;t<o;t++){var i=e.failedRequests[2*t]||ke.EMPTY_STRING,a=e.failedRequests[2*t+1]||ke.EMPTY_STRING,s=e.errors[t]||ke.EMPTY_STRING;if(!((n+=i.toString().length+a.toString().length+s.length+3)<Ve.MAX_LAST_HEADER_BYTES))break;r+=1}return r},e.prototype.getRegionDiscoveryFields=function(){var e=[];return e.push(this.regionUsed||""),e.push(this.regionSource||""),e.push(this.regionOutcome||""),e.join(",")},e.prototype.updateRegionDiscoveryMetadata=function(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome},e.prototype.setCacheOutcome=function(e){this.cacheOutcome=e},e}(),Sn="invalid_grant",An=483,_n=600,In="msal",bn=50,Rn="msal.js.browser";
/*! @azure/msal-common v5.0.1 2021-10-05 */!function(e){e.LocalStorage="localStorage",e.SessionStorage="sessionStorage",e.MemoryStorage="memoryStorage"}(un||(un={})),function(e){e.GET="GET",e.POST="POST"}(ln||(ln={})),function(e){e.AUTHORITY="authority",e.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",e.SESSION_STATE="session.state",e.REQUEST_STATE="request.state",e.NONCE_IDTOKEN="nonce.id_token",e.ORIGIN_URI="request.origin",e.RENEW_STATUS="token.renew.status",e.URL_HASH="urlHash",e.REQUEST_PARAMS="request.params",e.SCOPES="scopes",e.INTERACTION_STATUS_KEY="interaction.status",e.CCS_CREDENTIAL="ccs.credential",e.CORRELATION_ID="request.correlationId"}(dn||(dn={})),function(e){e.WRAPPER_SKU="wrapper.sku",e.WRAPPER_VER="wrapper.version"}(hn||(hn={})),function(e){e[e.acquireTokenRedirect=861]="acquireTokenRedirect",e[e.acquireTokenPopup=862]="acquireTokenPopup",e[e.ssoSilent=863]="ssoSilent",e[e.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",e[e.handleRedirectPromise=865]="handleRedirectPromise",e[e.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",e[e.logout=961]="logout",e[e.logoutPopup=962]="logoutPopup"}(pn||(pn={})),function(e){e.Redirect="redirect",e.Popup="popup",e.Silent="silent"}(fn||(fn={})),function(e){e.Startup="startup",e.Login="login",e.Logout="logout",e.AcquireToken="acquireToken",e.SsoSilent="ssoSilent",e.HandleRedirect="handleRedirect",e.None="none"}(gn||(gn={}));var On,kn={scopes:Ne},Nn="jwk";!function(e){e.React="@azure/msal-react",e.Angular="@azure/msal-angular"}(On||(On={}));
/*! @azure/msal-browser v2.18.0 2021-10-05 */
var Pn=function(){function e(){}return e.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},e}(),Un=function(){function e(e){this.cryptoObj=e}return e.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,Pn.decimalToHex(e[0])+Pn.decimalToHex(e[1])+Pn.decimalToHex(e[2])+Pn.decimalToHex(e[3])+"-"+Pn.decimalToHex(e[4])+Pn.decimalToHex(e[5])+"-"+Pn.decimalToHex(e[6])+Pn.decimalToHex(e[7])+"-"+Pn.decimalToHex(e[8])+Pn.decimalToHex(e[9])+"-"+Pn.decimalToHex(e[10])+Pn.decimalToHex(e[11])+Pn.decimalToHex(e[12])+Pn.decimalToHex(e[13])+Pn.decimalToHex(e[14])+Pn.decimalToHex(e[15])}catch(e){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",n=0,o="",i=0;i<36;i++)"-"!==t[i]&&"4"!==t[i]&&(n=16*Math.random()|0),"x"===t[i]?o+=r[n]:"y"===t[i]?(n&=3,o+=r[n|=8]):o+=t[i];return o}},e.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},e}(),Mn=function(){function e(){}return e.stringToUtf8Arr=function(e){for(var t,r=0,n=e.length,o=0;o<n;o++)r+=(t=e.charCodeAt(o))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var i=new Uint8Array(r),a=0,s=0;a<r;s++)(t=e.charCodeAt(s))<128?i[a++]=t:t<2048?(i[a++]=192+(t>>>6),i[a++]=128+(63&t)):t<65536?(i[a++]=224+(t>>>12),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):t<2097152?(i[a++]=240+(t>>>18),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):t<67108864?(i[a++]=248+(t>>>24),i[a++]=128+(t>>>18&63),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t)):(i[a++]=252+(t>>>30),i[a++]=128+(t>>>24&63),i[a++]=128+(t>>>18&63),i[a++]=128+(t>>>12&63),i[a++]=128+(t>>>6&63),i[a++]=128+(63&t));return i},e.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t},e.utf8ArrToString=function(e){for(var t="",r=void 0,n=e.length,o=0;o<n;o++)r=e[o],t+=String.fromCharCode(r>251&&r<254&&o+5<n?1073741824*(r-252)+(e[++o]-128<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>247&&r<252&&o+4<n?(r-248<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>239&&r<248&&o+3<n?(r-240<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:r>223&&r<240&&o+2<n?(r-224<<12)+(e[++o]-128<<6)+e[++o]-128:r>191&&r<224&&o+1<n?(r-192<<6)+e[++o]-128:r);return t},e}(),Ln=function(){function e(){}return e.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))},e.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},e.prototype.encode=function(e){var t=Mn.stringToUtf8Arr(e);return this.base64EncArr(t)},e.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r="",n=void 0,o=e.length,i=0,a=0;a<o;a++)n=a%3,i|=e[a]<<(16>>>n&24),2!==n&&e.length-a!=1||(r+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(63&i)),i=0);return 0===t?r:r.substring(0,r.length-t)+(1===t?"=":"==")},e.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},e}(),Hn=function(){function e(){}return e.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return Mn.utf8ArrToString(r)},e.prototype.base64DecToArr=function(e,t){for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,""),n=r.length,o=t?Math.ceil((3*n+1>>>2)/t)*t:3*n+1>>>2,i=new Uint8Array(o),a=void 0,s=void 0,c=0,u=0,l=0;l<n;l++)if(s=3&l,c|=this.b64ToUint6(r.charCodeAt(l))<<18-6*s,3===s||n-l==1){for(a=0;a<3&&u<o;a++,u++)i[u]=c>>>(16>>>a&24)&255;c=0}return i},e.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},e}(),Dn={code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},qn={code:"crypto_nonexistent",desc:"The crypto object or function is not available."},Fn={code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},xn={code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},Kn={code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash."},Gn={code:"no_state_in_hash",desc:"Hash does not contain state. Please verify that the request originated from msal."},Bn={code:"hash_does_not_contain_known_properties",desc:"Hash does not contain known properites. Please verify that your redirectUri is not changing the hash."},jn={code:"unable_to_parse_state",desc:"Unable to parse state. Please verify that the request originated from msal."},zn={code:"state_interaction_type_mismatch",desc:"Hash contains state but the interaction type does not match the caller."},Wn={code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors."},$n={code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},Yn={code:"empty_window_error",desc:"window.open returned null or undefined window object."},Vn={code:"user_cancelled",desc:"User cancelled the flow."},Qn={code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},Jn={code:"monitor_window_timeout",desc:"Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors."},Xn={code:"redirect_in_iframe",desc:"Code flow is not supported inside an iframe. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},Zn={code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors"},eo={code:"block_nested_popups",desc:"Request was blocked inside a popup because MSAL detected it was running in a popup."},to={code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},ro={code:"silent_logout_unsupported",desc:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead."},no={code:"no_account_error",desc:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request."},oo={code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none'."},io={code:"no_token_request_cache_error",desc:"No token request in found in cache."},ao={code:"unable_to_parse_token_request_cache_error",desc:"The cached token request could not be parsed."},so={code:"no_cached_authority_error",desc:"No cached authority found."},co={code:"auth_request_not_set_error",desc:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler"},uo={code:"invalid_cache_type",desc:"Invalid cache type"},lo={code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."},ho={code:"database_not_open",desc:"Database is not open!"},po={code:"no_network_connectivity",desc:"No network connectivity. Check your internet connection."},fo={code:"post_request_failed",desc:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'"},go={code:"get_request_failed",desc:"Network request failed. Please check the network trace to determine root cause."},yo={code:"failed_to_parse_response",desc:"Failed to parse network response. Check network trace."},mo={code:"unable_to_load_token",desc:"Error loading token to cache."},vo={code:"crypto_key_not_found",desc:"Cryptographic Key or Keypair not found in browser storage."},Eo=function(e){function t(r,n){var o=e.call(this,r,n)||this;return Object.setPrototypeOf(o,t.prototype),o.name="BrowserAuthError",o}return pe(t,e),t.createPkceNotGeneratedError=function(e){return new t(Dn.code,Dn.desc+" Detail:"+e)},t.createCryptoNotAvailableError=function(e){return new t(qn.code,qn.desc+" Detail:"+e)},t.createHttpMethodNotImplementedError=function(e){return new t(Fn.code,Fn.desc+" Given Method: "+e)},t.createEmptyNavigationUriError=function(){return new t(xn.code,xn.desc)},t.createEmptyHashError=function(e){return new t(Kn.code,Kn.desc+" Given Url: "+e)},t.createHashDoesNotContainStateError=function(){return new t(Gn.code,Gn.desc)},t.createHashDoesNotContainKnownPropertiesError=function(){return new t(Bn.code,Bn.desc)},t.createUnableToParseStateError=function(){return new t(jn.code,jn.desc)},t.createStateInteractionTypeMismatchError=function(){return new t(zn.code,zn.desc)},t.createInteractionInProgressError=function(){return new t(Wn.code,Wn.desc)},t.createPopupWindowError=function(e){var r=$n.desc;return r=Xt.isEmpty(e)?r:r+" Details: "+e,new t($n.code,r)},t.createEmptyWindowCreatedError=function(){return new t(Yn.code,Yn.desc)},t.createUserCancelledError=function(){return new t(Vn.code,Vn.desc)},t.createMonitorPopupTimeoutError=function(){return new t(Qn.code,Qn.desc)},t.createMonitorIframeTimeoutError=function(){return new t(Jn.code,Jn.desc)},t.createRedirectInIframeError=function(e){return new t(Xn.code,Xn.desc+" (window.parent !== window) => "+e)},t.createBlockReloadInHiddenIframeError=function(){return new t(Zn.code,Zn.desc)},t.createBlockAcquireTokenInPopupsError=function(){return new t(eo.code,eo.desc)},t.createIframeClosedPrematurelyError=function(){return new t(to.code,to.desc)},t.createSilentLogoutUnsupportedError=function(){return new t(ro.code,ro.desc)},t.createNoAccountError=function(){return new t(no.code,no.desc)},t.createSilentPromptValueError=function(e){return new t(oo.code,oo.desc+" Given value: "+e)},t.createUnableToParseTokenRequestCacheError=function(){return new t(ao.code,ao.desc)},t.createNoTokenRequestCacheError=function(){return new t(io.code,io.desc)},t.createAuthRequestNotSetError=function(){return new t(co.code,co.desc)},t.createNoCachedAuthorityError=function(){return new t(so.code,so.desc)},t.createInvalidCacheTypeError=function(){return new t(uo.code,""+uo.desc)},t.createNonBrowserEnvironmentError=function(){return new t(lo.code,lo.desc)},t.createDatabaseNotOpenError=function(){return new t(ho.code,ho.desc)},t.createNoNetworkConnectivityError=function(){return new t(po.code,po.desc)},t.createPostRequestFailedError=function(e,r){return new t(fo.code,fo.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createGetRequestFailedError=function(e,r){return new t(go.code,go.desc+" | Network client threw: "+e+" | Attempted to reach: "+r.split("?")[0])},t.createFailedToParseNetworkResponseError=function(e){return new t(yo.code,yo.desc+" | Attempted to reach: "+e.split("?")[0])},t.createUnableToLoadTokenError=function(e){return new t(mo.code,mo.desc+" | "+e)},t.createSigningKeyNotFoundInStorageError=function(e){return new t(vo.code,vo.desc+" | No match found for KeyId: "+e)},t}(ut),Co=function(){function e(e){this.base64Encode=new Ln,this.cryptoObj=e}return e.prototype.generateCodes=function(){return ge(this,void 0,void 0,(function(){var e,t;return ye(this,(function(r){switch(r.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=r.sent(),[2,{verifier:e,challenge:t}]}}))}))},e.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(e){throw Eo.createPkceNotGeneratedError(e)}},e.prototype.generateCodeChallengeFromVerifier=function(e){return ge(this,void 0,void 0,(function(){var t,r;return ye(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=n.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=n.sent(),Eo.createPkceNotGeneratedError(r);case 3:return[2]}}))}))},e}(),wo="SHA-256",To=new Uint8Array([1,0,1]),So=function(){function e(){if(!this.hasCryptoAPI())throw Eo.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.");this._keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:wo,modulusLength:2048,publicExponent:To}}return e.prototype.sha256Digest=function(e){return ge(this,void 0,void 0,(function(){var t;return ye(this,(function(r){return t=Mn.stringToUtf8Arr(e),[2,this.hasIECrypto()?this.getMSCryptoDigest(wo,t):this.getSubtleCryptoDigest(wo,t)]}))}))},e.prototype.getRandomValues=function(e){var t=window.msCrypto||window.crypto;if(!t.getRandomValues)throw Eo.createCryptoNotAvailableError("getRandomValues does not exist.");t.getRandomValues(e)},e.prototype.generateKeyPair=function(e,t){return ge(this,void 0,void 0,(function(){return ye(this,(function(r){return[2,this.hasIECrypto()?this.msCryptoGenerateKey(e,t):window.crypto.subtle.generateKey(this._keygenAlgorithmOptions,e,t)]}))}))},e.prototype.exportJwk=function(e){return ge(this,void 0,void 0,(function(){return ye(this,(function(t){return[2,this.hasIECrypto()?this.msCryptoExportJwk(e):window.crypto.subtle.exportKey(Nn,e)]}))}))},e.prototype.importJwk=function(t,r,n){return ge(this,void 0,void 0,(function(){var o,i;return ye(this,(function(a){return o=e.getJwkString(t),i=Mn.stringToArrayBuffer(o),[2,this.hasIECrypto()?this.msCryptoImportKey(i,r,n):window.crypto.subtle.importKey(Nn,t,this._keygenAlgorithmOptions,r,n)]}))}))},e.prototype.sign=function(e,t){return ge(this,void 0,void 0,(function(){return ye(this,(function(r){return[2,this.hasIECrypto()?this.msCryptoSign(e,t):window.crypto.subtle.sign(this._keygenAlgorithmOptions,e,t)]}))}))},e.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},e.prototype.hasIECrypto=function(){return"msCrypto"in window},e.prototype.hasBrowserCrypto=function(){return"crypto"in window},e.prototype.getSubtleCryptoDigest=function(e,t){return ge(this,void 0,void 0,(function(){return ye(this,(function(r){return[2,window.crypto.subtle.digest(e,t)]}))}))},e.prototype.getMSCryptoDigest=function(e,t){return ge(this,void 0,void 0,(function(){return ye(this,(function(r){return[2,new Promise((function(r,n){var o=window.msCrypto.subtle.digest(e,t.buffer);o.addEventListener("complete",(function(e){r(e.target.result)})),o.addEventListener("error",(function(e){n(e)}))}))]}))}))},e.prototype.msCryptoGenerateKey=function(e,t){return ge(this,void 0,void 0,(function(){var r=this;return ye(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.generateKey(r._keygenAlgorithmOptions,e,t);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.prototype.msCryptoExportJwk=function(e){return ge(this,void 0,void 0,(function(){return ye(this,(function(t){return[2,new Promise((function(t,r){var n=window.msCrypto.subtle.exportKey(Nn,e);n.addEventListener("complete",(function(e){var n=e.target.result,o=Mn.utf8ArrToString(new Uint8Array(n)).replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"").split(" ").join("").replace("\0","");try{t(JSON.parse(o))}catch(e){r(e)}})),n.addEventListener("error",(function(e){r(e)}))}))]}))}))},e.prototype.msCryptoImportKey=function(e,t,r){return ge(this,void 0,void 0,(function(){var n=this;return ye(this,(function(o){return[2,new Promise((function(o,i){var a=window.msCrypto.subtle.importKey(Nn,e,n._keygenAlgorithmOptions,t,r);a.addEventListener("complete",(function(e){o(e.target.result)})),a.addEventListener("error",(function(e){i(e)}))}))]}))}))},e.prototype.msCryptoSign=function(e,t){return ge(this,void 0,void 0,(function(){var r=this;return ye(this,(function(n){return[2,new Promise((function(n,o){var i=window.msCrypto.subtle.sign(r._keygenAlgorithmOptions,e,t);i.addEventListener("complete",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){o(e)}))}))]}))}))},e.getJwkString=function(e){return JSON.stringify(e,Object.keys(e).sort())},e}(),Ao=function(){function e(e,t,r){this.dbName=e,this.tableName=t,this.version=r,this.dbOpen=!1}return e.prototype.open=function(){return ge(this,void 0,void 0,(function(){var e=this;return ye(this,(function(t){return[2,new Promise((function(t,r){var n=window.indexedDB.open(e.dbName,e.version);n.addEventListener("upgradeneeded",(function(t){t.target.result.createObjectStore(e.tableName)})),n.addEventListener("success",(function(r){var n=r;e.db=n.target.result,e.dbOpen=!0,t()})),n.addEventListener("error",(function(e){return r(e)}))}))]}))}))},e.prototype.get=function(e){return ge(this,void 0,void 0,(function(){var t=this;return ye(this,(function(r){switch(r.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:r.sent(),r.label=2;case 2:return[2,new Promise((function(r,n){if(!t.db)return n(Eo.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).get(e);o.addEventListener("success",(function(e){r(e.target.result)})),o.addEventListener("error",(function(e){return n(e)}))}))]}}))}))},e.prototype.put=function(e,t){return ge(this,void 0,void 0,(function(){var r=this;return ye(this,(function(n){switch(n.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:n.sent(),n.label=2;case 2:return[2,new Promise((function(n,o){if(!r.db)return o(Eo.createDatabaseNotOpenError());var i=r.db.transaction([r.tableName],"readwrite").objectStore(r.tableName).put(t,e);i.addEventListener("success",(function(e){n(e.target.result)})),i.addEventListener("error",(function(e){return o(e)}))}))]}}))}))},e.prototype.delete=function(e){return ge(this,void 0,void 0,(function(){var t=this;return ye(this,(function(r){switch(r.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:r.sent(),r.label=2;case 2:return[2,new Promise((function(r,n){if(!t.db)return n(Eo.createDatabaseNotOpenError());var o=t.db.transaction([t.tableName],"readwrite").objectStore(t.tableName).delete(e);o.addEventListener("success",(function(e){r(void 0===e.target.result)})),o.addEventListener("error",(function(e){return n(e)}))}))]}}))}))},e.prototype.clear=function(){return ge(this,void 0,void 0,(function(){var e=this;return ye(this,(function(t){switch(t.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:t.sent(),t.label=2;case 2:return[2,new Promise((function(t,r){if(!e.db)return r(Eo.createDatabaseNotOpenError());var n=e.db.transaction([e.tableName],"readwrite").objectStore(e.tableName).clear();n.addEventListener("success",(function(e){t(void 0===e.target.result)})),n.addEventListener("error",(function(e){return r(e)}))}))]}}))}))},e}(),_o=function(){function e(){this.browserCrypto=new So,this.b64Encode=new Ln,this.b64Decode=new Hn,this.guidGenerator=new Un(this.browserCrypto),this.pkceGenerator=new Co(this.browserCrypto),this.cache=new Ao(e.DB_NAME,e.TABLE_NAME,e.DB_VERSION)}return e.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},e.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},e.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},e.prototype.generatePkceCodes=function(){return ge(this,void 0,void 0,(function(){return ye(this,(function(e){return[2,this.pkceGenerator.generateCodes()]}))}))},e.prototype.getPublicKeyThumbprint=function(t){return ge(this,void 0,void 0,(function(){var r,n,o,i,a,s,c,u;return ye(this,(function(l){switch(l.label){case 0:return[4,this.browserCrypto.generateKeyPair(e.EXTRACTABLE,e.POP_KEY_USAGES)];case 1:return r=l.sent(),[4,this.browserCrypto.exportJwk(r.publicKey)];case 2:return n=l.sent(),o={e:n.e,kty:n.kty,n:n.n},i=So.getJwkString(o),[4,this.browserCrypto.sha256Digest(i)];case 3:return a=l.sent(),s=this.b64Encode.urlEncodeArr(new Uint8Array(a)),[4,this.browserCrypto.exportJwk(r.privateKey)];case 4:return c=l.sent(),[4,this.browserCrypto.importJwk(c,!1,["sign"])];case 5:return u=l.sent(),[4,this.cache.put(s,{privateKey:u,publicKey:r.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri})];case 6:return l.sent(),[2,s]}}))}))},e.prototype.removeTokenBindingKey=function(e){return ge(this,void 0,void 0,(function(){return ye(this,(function(t){return[2,this.cache.delete(e)]}))}))},e.prototype.clearKeystore=function(){return ge(this,void 0,void 0,(function(){return ye(this,(function(e){return[2,this.cache.clear()]}))}))},e.prototype.signJwt=function(e,t){return ge(this,void 0,void 0,(function(){var r,n,o,i,a,s,c,u,l,d;return ye(this,(function(h){switch(h.label){case 0:return[4,this.cache.get(t)];case 1:if(!(r=h.sent()))throw Eo.createSigningKeyNotFoundInStorageError(t);return[4,this.browserCrypto.exportJwk(r.publicKey)];case 2:return n=h.sent(),o=So.getJwkString(n),i={alg:n.alg,type:Nn},a=this.b64Encode.urlEncode(JSON.stringify(i)),e.cnf={jwk:JSON.parse(o)},s=this.b64Encode.urlEncode(JSON.stringify(e)),c=a+"."+s,u=Mn.stringToArrayBuffer(c),[4,this.browserCrypto.sign(r.privateKey,u)];case 3:return l=h.sent(),d=this.b64Encode.urlEncodeArr(new Uint8Array(l)),[2,c+"."+d]}}))}))},e.POP_KEY_USAGES=["sign","verify"],e.EXTRACTABLE=!0,e.DB_VERSION=1,e.DB_NAME="msal.db",e.TABLE_NAME=e.DB_NAME+".keys",e}(),Io={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},bo={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},Ro={code:"storage_not_supported",desc:"Given storage configuration option was not supported."},Oo={code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},ko={code:"stubbed_public_client_application_called",desc:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors"},No={code:"in_mem_redirect_unavailable",desc:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},Po=function(e){function t(r,n){var o=e.call(this,r,n)||this;return o.name="BrowserConfigurationAuthError",Object.setPrototypeOf(o,t.prototype),o}return pe(t,e),t.createRedirectUriEmptyError=function(){return new t(Io.code,Io.desc)},t.createPostLogoutRedirectUriEmptyError=function(){return new t(bo.code,bo.desc)},t.createStorageNotSupportedError=function(e){return new t(Ro.code,Ro.desc+" Given Location: "+e)},t.createRedirectCallbacksNotSetError=function(){return new t(Oo.code,Oo.desc)},t.createStubPcaInstanceCalledError=function(){return new t(ko.code,ko.desc)},t.createInMemoryRedirectUnavailableError=function(){return new t(No.code,No.desc)},t}(ut),Uo=function(){function e(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return e.prototype.validateWindowStorage=function(e){if(e!==un.LocalStorage&&e!==un.SessionStorage)throw Po.createStorageNotSupportedError(e);if(!!!window[e])throw Po.createStorageNotSupportedError(e)},e.prototype.getItem=function(e){return this.windowStorage.getItem(e)},e.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},e.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},e.prototype.getKeys=function(){return Object.keys(this.windowStorage)},e.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},e}(),Mo=function(){function e(){this.cache=new Map}return e.prototype.getItem=function(e){return this.cache.get(e)||null},e.prototype.setItem=function(e,t){this.cache.set(e,t)},e.prototype.removeItem=function(e){this.cache.delete(e)},e.prototype.getKeys=function(){var e=[];return this.cache.forEach((function(t,r){e.push(r)})),e},e.prototype.containsKey=function(e){return this.cache.has(e)},e.prototype.clear=function(){this.cache.clear()},e}(),Lo=function(){function e(){}return e.extractBrowserRequestState=function(e,t){if(Xt.isEmpty(t))return null;try{return Qr.parseRequestState(e,t).libraryState.meta}catch(e){throw Jt.createInvalidStateError(t,e)}},e.parseServerResponseFromHash=function(e){if(!e)return{};var t=new Jr(e);return Jr.getDeserializedHash(t.getHash())},e}(),Ho=function(e){function t(t,r,n,o){var i=e.call(this,t,n)||this;return i.COOKIE_LIFE_MULTIPLIER=864e5,i.cacheConfig=r,i.logger=o,i.internalStorage=new Mo,i.browserStorage=i.setupBrowserStorage(i.cacheConfig.cacheLocation),i.temporaryCacheStorage=i.setupTemporaryCacheStorage(i.cacheConfig.cacheLocation),i.migrateCacheEntries(),i}return pe(t,e),t.prototype.setupBrowserStorage=function(e){switch(e){case un.LocalStorage:case un.SessionStorage:try{return new Uo(e)}catch(e){this.logger.verbose(e);break}}return this.cacheConfig.cacheLocation=un.MemoryStorage,new Mo},t.prototype.setupTemporaryCacheStorage=function(e){switch(e){case un.LocalStorage:case un.SessionStorage:try{return new Uo(un.SessionStorage)}catch(e){return this.logger.verbose(e),this.internalStorage}case un.MemoryStorage:default:return this.internalStorage}},t.prototype.migrateCacheEntries=function(){var e=this,t=ke.CACHE_PREFIX+"."+Ie.ID_TOKEN,r=ke.CACHE_PREFIX+"."+Ie.CLIENT_INFO,n=ke.CACHE_PREFIX+"."+Ie.ERROR,o=ke.CACHE_PREFIX+"."+Ie.ERROR_DESC,i=[this.browserStorage.getItem(t),this.browserStorage.getItem(r),this.browserStorage.getItem(n),this.browserStorage.getItem(o)];[Ie.ID_TOKEN,Ie.CLIENT_INFO,Ie.ERROR,Ie.ERROR_DESC].forEach((function(t,r){return e.migrateCacheEntry(t,i[r])}))},t.prototype.migrateCacheEntry=function(e,t){t&&this.setTemporaryCache(e,t,!0)},t.prototype.validateAndParseJson=function(e){try{var t=JSON.parse(e);return t&&"object"==typeof t?t:null}catch(e){return null}},t.prototype.getItem=function(e){return this.browserStorage.getItem(e)},t.prototype.setItem=function(e,t){this.browserStorage.setItem(e,t)},t.prototype.getAccount=function(e){var t=this.getItem(e);if(!t)return null;var r=this.validateAndParseJson(t);return r&&Ar.isAccountEntity(r)?Ir.toObject(new Ar,r):null},t.prototype.setAccount=function(e){this.logger.trace("BrowserCacheManager.setAccount called");var t=e.generateAccountKey();this.setItem(t,JSON.stringify(e))},t.prototype.getIdTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Kr.isIdTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),Ir.toObject(new Kr,r)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null)},t.prototype.setIdTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getAccessTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Br.isAccessTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),Ir.toObject(new Br,r)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)},t.prototype.setAccessTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getRefreshTokenCredential=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&jr.isRefreshTokenEntity(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),Ir.toObject(new jr,r)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)},t.prototype.setRefreshTokenCredential=function(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var t=e.generateCredentialKey();this.setItem(t,JSON.stringify(e))},t.prototype.getAppMetadata=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&en.isAppMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),Ir.toObject(new en,r)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},t.prototype.setAppMetadata=function(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");var t=e.generateAppMetadataKey();this.setItem(t,JSON.stringify(e))},t.prototype.getServerTelemetry=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&En.isServerTelemetryEntity(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),Ir.toObject(new En,r)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},t.prototype.setServerTelemetry=function(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))},t.prototype.getAuthorityMetadata=function(e){var t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&cn.isAuthorityMetadataEntity(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),Ir.toObject(new cn,r)):null},t.prototype.getAuthorityMetadataKeys=function(){var e=this;return this.internalStorage.getKeys().filter((function(t){return e.isAuthorityMetadata(t)}))},t.prototype.setWrapperMetadata=function(e,t){this.internalStorage.setItem(hn.WRAPPER_SKU,e),this.internalStorage.setItem(hn.WRAPPER_VER,t)},t.prototype.getWrapperMetadata=function(){return[this.internalStorage.getItem(hn.WRAPPER_SKU)||"",this.internalStorage.getItem(hn.WRAPPER_VER)||""]},t.prototype.setAuthorityMetadata=function(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))},t.prototype.getActiveAccount=function(){var e=this.generateCacheKey(Ie.ACTIVE_ACCOUNT),t=this.browserStorage.getItem(e);return t&&this.getAccountInfoByFilter({localAccountId:t})[0]||null},t.prototype.setActiveAccount=function(e){var t=this.generateCacheKey(Ie.ACTIVE_ACCOUNT);e?(this.logger.verbose("setActiveAccount: Active account set"),this.browserStorage.setItem(t,e.localAccountId)):(this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t))},t.prototype.getAccountInfoByFilter=function(e){return this.getAllAccounts().filter((function(t){return(!e.username||e.username.toLowerCase()===t.username.toLowerCase())&&((!e.homeAccountId||e.homeAccountId===t.homeAccountId)&&((!e.localAccountId||e.localAccountId===t.localAccountId)&&((!e.tenantId||e.tenantId===t.tenantId)&&(!e.environment||e.environment===t.environment))))}))},t.prototype.getThrottlingCache=function(e){var t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var r=this.validateAndParseJson(t);return r&&Cn.isThrottlingEntity(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),Ir.toObject(new Cn,r)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},t.prototype.setThrottlingCache=function(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))},t.prototype.getTemporaryCache=function(e,t){var r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){var n=this.getItemCookie(r);if(n)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),n}var o=this.temporaryCacheStorage.getItem(r);if(!o){if(this.cacheConfig.cacheLocation===un.LocalStorage){var i=this.browserStorage.getItem(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),o},t.prototype.setTemporaryCache=function(e,t,r){var n=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(n,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(n,t))},t.prototype.removeItem=function(e){return this.browserStorage.removeItem(e),this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e)),!0},t.prototype.containsKey=function(e){return this.browserStorage.containsKey(e)||this.temporaryCacheStorage.containsKey(e)},t.prototype.getKeys=function(){return ve(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},t.prototype.clear=function(){return ge(this,void 0,void 0,(function(){var e=this;return ye(this,(function(t){switch(t.label){case 0:return[4,this.removeAllAccounts()];case 1:return t.sent(),this.removeAppMetadata(),this.getKeys().forEach((function(t){!e.browserStorage.containsKey(t)&&!e.temporaryCacheStorage.containsKey(t)||-1===t.indexOf(ke.CACHE_PREFIX)&&-1===t.indexOf(e.clientId)||e.removeItem(t)})),this.internalStorage.clear(),[2]}}))}))},t.prototype.setItemCookie=function(e,t,r){var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";");this.cacheConfig.secureCookies&&(n+="Secure;"),document.cookie=n},t.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return""},t.prototype.clearMsalCookies=function(){var e=this,t=ke.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach((function(r){for(;" "===r.charAt(0);)r=r.substring(1);if(0===r.indexOf(t)){var n=r.split("=")[0];e.clearItemCookie(n)}}))},t.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},t.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},t.prototype.getCache=function(){return this.browserStorage},t.prototype.setCache=function(){},t.prototype.generateCacheKey=function(e){return this.validateAndParseJson(e)?JSON.stringify(e):Xt.startsWith(e,ke.CACHE_PREFIX)||Xt.startsWith(e,Ie.ADAL_ID_TOKEN)?e:ke.CACHE_PREFIX+"."+this.clientId+"."+e},t.prototype.generateAuthorityKey=function(e){var t=Qr.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(dn.AUTHORITY+"."+t)},t.prototype.generateNonceKey=function(e){var t=Qr.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(dn.NONCE_IDTOKEN+"."+t)},t.prototype.generateStateKey=function(e){var t=Qr.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(dn.REQUEST_STATE+"."+t)},t.prototype.getCachedAuthority=function(e){var t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;var n=this.generateAuthorityKey(r);return this.getTemporaryCache(n)},t.prototype.updateCacheEntries=function(e,t,r,n,o){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var i=this.generateStateKey(e);this.setTemporaryCache(i,e,!1);var a=this.generateNonceKey(e);this.setTemporaryCache(a,t,!1);var s=this.generateAuthorityKey(e);if(this.setTemporaryCache(s,r,!1),o){var c={credential:o.homeAccountId,type:Ur.HOME_ACCOUNT_ID};this.setTemporaryCache(dn.CCS_CREDENTIAL,JSON.stringify(c),!0)}else if(!Xt.isEmpty(n)){c={credential:n,type:Ur.UPN};this.setTemporaryCache(dn.CCS_CREDENTIAL,JSON.stringify(c),!0)}},t.prototype.resetRequestCache=function(e){var t=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),Xt.isEmpty(e)||this.getKeys().forEach((function(r){-1!==r.indexOf(e)&&t.removeItem(r)})),e&&(this.removeItem(this.generateStateKey(e)),this.removeItem(this.generateNonceKey(e)),this.removeItem(this.generateAuthorityKey(e))),this.removeItem(this.generateCacheKey(dn.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(dn.ORIGIN_URI)),this.removeItem(this.generateCacheKey(dn.URL_HASH)),this.removeItem(this.generateCacheKey(dn.CORRELATION_ID)),this.removeItem(this.generateCacheKey(dn.CCS_CREDENTIAL)),this.setInteractionInProgress(!1)},t.prototype.cleanRequestByState=function(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){var t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+r),this.resetRequestCache(r||"")}this.clearMsalCookies()},t.prototype.cleanRequestByInteractionType=function(e){var t=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach((function(r){if(-1!==r.indexOf(dn.REQUEST_STATE)){var n=t.temporaryCacheStorage.getItem(r);if(n){var o=Lo.extractBrowserRequestState(t.cryptoImpl,n);o&&o.interactionType===e&&(t.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+n),t.resetRequestCache(n))}}})),this.clearMsalCookies()},t.prototype.cacheCodeRequest=function(e,t){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var r=t.base64Encode(JSON.stringify(e));this.setTemporaryCache(dn.REQUEST_PARAMS,r,!0)},t.prototype.getCachedRequest=function(e,t){this.logger.trace("BrowserCacheManager.getCachedRequest called");var r=this.getTemporaryCache(dn.REQUEST_PARAMS,!0);if(!r)throw Eo.createNoTokenRequestCacheError();var n=this.validateAndParseJson(t.base64Decode(r));if(!n)throw Eo.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(dn.REQUEST_PARAMS)),Xt.isEmpty(n.authority)){var o=this.generateAuthorityKey(e),i=this.getTemporaryCache(o);if(!i)throw Eo.createNoCachedAuthorityError();n.authority=i}return n},t.prototype.isInteractionInProgress=function(e){var t=this.getInteractionInProgress();return e?t===this.clientId:!!t},t.prototype.getInteractionInProgress=function(){var e=ke.CACHE_PREFIX+"."+dn.INTERACTION_STATUS_KEY;return this.getTemporaryCache(e,!1)},t.prototype.setInteractionInProgress=function(e){var t=this.getInteractionInProgress(),r=ke.CACHE_PREFIX+"."+dn.INTERACTION_STATUS_KEY;e&&!t?this.setTemporaryCache(r,this.clientId,!1):e||t!==this.clientId||this.removeItem(r)},t.prototype.getLegacyLoginHint=function(){var e=this.getTemporaryCache(Ie.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(Ie.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var t=this.getTemporaryCache(Ie.ID_TOKEN,!0);t&&(this.removeItem(this.generateCacheKey(Ie.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var r=t||e;if(r){var n=new _r(r,this.cryptoImpl);if(n.claims&&n.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),n.claims.preferred_username;if(n.claims&&n.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),n.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},t}(Ir),Do=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return ge(this,void 0,void 0,(function(){var r,n,o;return ye(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,fetch(e,{method:ln.GET,headers:this.getFetchHeaders(t)})];case 1:return r=i.sent(),[3,3];case 2:throw n=i.sent(),window.navigator.onLine?Eo.createGetRequestFailedError(n,e):Eo.createNoNetworkConnectivityError();case 3:return i.trys.push([3,5,,6]),o={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 4:return[2,(o.body=i.sent(),o.status=r.status,o)];case 5:throw i.sent(),Eo.createFailedToParseNetworkResponseError(e);case 6:return[2]}}))}))},e.prototype.sendPostRequestAsync=function(e,t){return ge(this,void 0,void 0,(function(){var r,n,o,i;return ye(this,(function(a){switch(a.label){case 0:r=t&&t.body||"",a.label=1;case 1:return a.trys.push([1,3,,4]),[4,fetch(e,{method:ln.POST,headers:this.getFetchHeaders(t),body:r})];case 2:return n=a.sent(),[3,4];case 3:throw o=a.sent(),window.navigator.onLine?Eo.createPostRequestFailedError(o,e):Eo.createNoNetworkConnectivityError();case 4:return a.trys.push([4,6,,7]),i={headers:this.getHeaderDict(n.headers)},[4,n.json()];case 5:return[2,(i.body=a.sent(),i.status=n.status,i)];case 6:throw a.sent(),Eo.createFailedToParseNetworkResponseError(e);case 7:return[2]}}))}))},e.prototype.getFetchHeaders=function(e){var t=new Headers;if(!e||!e.headers)return t;var r=e.headers;return Object.keys(r).forEach((function(e){t.append(e,r[e])})),t},e.prototype.getHeaderDict=function(e){var t={};return e.forEach((function(e,r){t[r]=e})),t},e}(),qo=function(){function e(){}return e.prototype.sendGetRequestAsync=function(e,t){return ge(this,void 0,void 0,(function(){return ye(this,(function(r){return[2,this.sendRequestAsync(e,ln.GET,t)]}))}))},e.prototype.sendPostRequestAsync=function(e,t){return ge(this,void 0,void 0,(function(){return ye(this,(function(r){return[2,this.sendRequestAsync(e,ln.POST,t)]}))}))},e.prototype.sendRequestAsync=function(e,t,r){var n=this;return new Promise((function(o,i){var a=new XMLHttpRequest;if(a.open(t,e,!0),n.setXhrHeaders(a,r),a.onload=function(){(a.status<200||a.status>=300)&&(t===ln.POST?i(Eo.createPostRequestFailedError("Failed with status "+a.status,e)):i(Eo.createGetRequestFailedError("Failed with status "+a.status,e)));try{var r=JSON.parse(a.responseText),s={headers:n.getHeaderDict(a),body:r,status:a.status};o(s)}catch(t){i(Eo.createFailedToParseNetworkResponseError(e))}},a.onerror=function(){window.navigator.onLine?t===ln.POST?i(Eo.createPostRequestFailedError("Failed with status "+a.status,e)):i(Eo.createGetRequestFailedError("Failed with status "+a.status,e)):i(Eo.createNoNetworkConnectivityError())},t===ln.POST&&r&&r.body)a.send(r.body);else{if(t!==ln.GET)throw Eo.createHttpMethodNotImplementedError(t);a.send()}}))},e.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var r=t.headers;Object.keys(r).forEach((function(t){e.setRequestHeader(t,r[t])}))}},e.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),r={};return t.forEach((function(e){var t=e.split(": "),n=t.shift(),o=t.join(": ");n&&o&&(r[n]=o)})),r},e}(),Fo=function(){function e(){}return e.clearHash=function(e){e.location.hash=ke.EMPTY_STRING,"function"==typeof e.history.replaceState&&e.history.replaceState(null,ke.EMPTY_STRING,""+e.location.origin+e.location.pathname+e.location.search)},e.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):""},e.isInIframe=function(){return window.parent!==window},e.isInPopup=function(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf(In+".")},e.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},e.getHomepage=function(){var e=new Jr(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},e.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new Do:new qo},e.blockReloadInHiddenIframes=function(){if(Jr.hashContainsKnownProperties(window.location.hash)&&e.isInIframe())throw Eo.createBlockReloadInHiddenIframeError()},e.blockRedirectInIframe=function(t,r){var n=e.isInIframe();if(t===fn.Redirect&&n&&!r)throw Eo.createRedirectInIframeError(n)},e.blockAcquireTokenInPopups=function(){if(e.isInPopup())throw Eo.createBlockAcquireTokenInPopupsError()},e.blockNonBrowserEnvironment=function(e){if(!e)throw Eo.createNonBrowserEnvironmentError()},e.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),n=e.indexOf("Edge/");return t>0||r>0||n>0},e}(),xo=function(){function e(){}return e.prototype.navigateInternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.prototype.navigateExternal=function(t,r){return e.defaultNavigateWindow(t,r)},e.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((function(e){setTimeout((function(){e(!0)}),t.timeout)}))},e}(),Ko=6e3;
/*! @azure/msal-browser v2.18.0 2021-10-05 */
/*! @azure/msal-browser v2.18.0 2021-10-05 */
var Go,Bo="2.18.0";!function(e){e.ACCOUNT_ADDED="msal:accountAdded",e.ACCOUNT_REMOVED="msal:accountRemoved",e.LOGIN_START="msal:loginStart",e.LOGIN_SUCCESS="msal:loginSuccess",e.LOGIN_FAILURE="msal:loginFailure",e.ACQUIRE_TOKEN_START="msal:acquireTokenStart",e.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",e.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",e.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",e.SSO_SILENT_START="msal:ssoSilentStart",e.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",e.SSO_SILENT_FAILURE="msal:ssoSilentFailure",e.HANDLE_REDIRECT_START="msal:handleRedirectStart",e.HANDLE_REDIRECT_END="msal:handleRedirectEnd",e.POPUP_OPENED="msal:popupOpened",e.LOGOUT_START="msal:logoutStart",e.LOGOUT_SUCCESS="msal:logoutSuccess",e.LOGOUT_FAILURE="msal:logoutFailure",e.LOGOUT_END="msal:logoutEnd"}(Go||(Go={}));
/*! @azure/msal-browser v2.18.0 2021-10-05 */
var jo=function(){function e(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return e.prototype.addEventCallback=function(e){if("undefined"!=typeof window){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},e.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},e.prototype.enableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},e.prototype.disableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},e.prototype.emitEvent=function(e,t,r,n){var o=this;if("undefined"!=typeof window){var i={eventType:e,interactionType:t||null,payload:r||null,error:n||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach((function(t,r){o.logger.verbose("Emitting event to callback "+r+": "+e),t.apply(null,[i])}))}},e.prototype.handleAccountCacheChange=function(e){try{var t=e.newValue||e.oldValue;if(!t)return;var r=JSON.parse(t);if("object"!=typeof r||!Ar.isAccountEntity(r))return;var n=Ir.toObject(new Ar,r).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(Go.ACCOUNT_ADDED,void 0,n)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(Go.ACCOUNT_REMOVED,void 0,n))}catch(e){return}},e}(),zo=function(e){function t(t,r,n,o,i,a,s){var c=e.call(this,t,r,n,o,i,s)||this;return c.navigationClient=a,c}return pe(t,e),t.prototype.initializeAuthorizationCodeRequest=function(e){return ge(this,void 0,void 0,(function(){var t,r;return ye(this,(function(n){switch(n.label){case 0:return this.logger.verbose("initializeAuthorizationRequest called",e.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return t=n.sent(),r=fe(fe({},e),{redirectUri:e.redirectUri,code:"",codeVerifier:t.verifier}),e.codeChallenge=t.challenge,e.codeChallengeMethod=ke.S256_CODE_CHALLENGE_METHOD,[2,r]}}))}))},t.prototype.initializeLogoutRequest=function(e){if(this.logger.verbose("initializeLogoutRequest called",null==e?void 0:e.correlationId),this.browserStorage.isInteractionInProgress())throw Eo.createInteractionInProgressError();var t=fe({correlationId:this.browserCrypto.createNewGuid()},e);return e&&null===e.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId):e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=Jr.getAbsoluteUrl(e.postLogoutRedirectUri,Fo.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=Jr.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,Fo.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=Jr.getAbsoluteUrl(Fo.getCurrentUri(),Fo.getCurrentUri())),t},t.prototype.createAuthCodeClient=function(e,t){return ge(this,void 0,void 0,(function(){var r;return ye(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new nn(r)]}}))}))},t.prototype.getClientConfiguration=function(e,t){return ge(this,void 0,void 0,(function(){var r;return ye(this,(function(n){switch(n.label){case 0:return this.logger.verbose("getClientConfiguration called"),[4,this.getDiscoveredAuthority(t)];case 1:return r=n.sent(),[2,{authOptions:{clientId:this.config.auth.clientId,authority:r,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled,logLevel:this.config.system.loggerOptions.logLevel,correlationId:this.correlationId},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:Rn,version:Bo,cpu:"",os:""}}]}}))}))},t.prototype.validateAndExtractStateFromHash=function(e,t,r){this.logger.verbose("validateAndExtractStateFromHash called",r);var n=Jr.getDeserializedHash(e);if(!n.state)throw Eo.createHashDoesNotContainStateError();var o=Lo.extractBrowserRequestState(this.browserCrypto,n.state);if(!o)throw Eo.createUnableToParseStateError();if(o.interactionType!==t)throw Eo.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",r),n.state},t.prototype.getDiscoveredAuthority=function(e){return ge(this,void 0,void 0,(function(){var t;return ye(this,(function(r){switch(r.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),t={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?(this.logger.verbose("Creating discovered authority with request authority"),[4,vn.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t)]):[3,2];case 1:case 3:return[2,r.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,vn.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t)]}}))}))},t.prototype.preflightInteractiveRequest=function(e,t){if(this.logger.verbose("preflightInteractiveRequest called, validating app environment",null==e?void 0:e.correlationId),Fo.blockReloadInHiddenIframes(),this.browserStorage.isInteractionInProgress(!1))throw Eo.createInteractionInProgressError();return this.initializeAuthorizationRequest(e,t)},t.prototype.initializeAuthorizationRequest=function(e,t){this.logger.verbose("initializeAuthorizationRequest called");var r=this.getRedirectUri(e.redirectUri),n={interactionType:t},o=Qr.setRequestState(this.browserCrypto,e&&e.state||"",n),i=fe(fe({},this.initializeBaseRequest(e)),{redirectUri:r,state:o,nonce:e.nonce||this.browserCrypto.createNewGuid(),responseMode:Le.FRAGMENT}),a=e.account||this.browserStorage.getActiveAccount();if(a&&(this.logger.verbose("Setting validated request account"),this.logger.verbosePii("Setting validated request account: "+a),i.account=a),Xt.isEmpty(i.loginHint)&&!a){var s=this.browserStorage.getLegacyLoginHint();s&&(i.loginHint=s)}return this.browserStorage.updateCacheEntries(i.state,i.nonce,i.authority,i.loginHint||"",i.account||null),i},t}(function(){function e(e,t,r,n,o,i){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.correlationId=i||this.browserCrypto.createNewGuid(),this.logger=n.clone(Rn,Bo,this.correlationId)}return e.prototype.clearCacheOnLogout=function(e){return ge(this,void 0,void 0,(function(){return ye(this,(function(t){switch(t.label){case 0:if(!e)return[3,5];Ar.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(Ar.generateAccountCacheKey(e))];case 2:return t.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return t.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return t.trys.push([5,8,,9]),[4,this.browserStorage.clear()];case 6:return t.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return t.sent(),this.logger.verbose("No account provided in logout request, clearing all cache items."),[3,9];case 8:return t.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}}))}))},e.prototype.initializeBaseRequest=function(e){this.logger.verbose("Initializing BaseAuthRequest");var t=e.authority||this.config.auth.authority,r=ve(e&&e.scopes||[]);return e.authenticationScheme?this.logger.verbose('Authentication Scheme set to "'+e.authenticationScheme+'" as configured in Auth request'):(e.authenticationScheme=Ye.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request')),fe(fe({},e),{correlationId:this.correlationId,authority:t,scopes:r})},e.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||Fo.getCurrentUri();return Jr.getAbsoluteUrl(t,Fo.getCurrentUri())},e.prototype.initializeServerTelemetryManager=function(e,t){this.logger.verbose("initializeServerTelemetryManager called");var r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Tn(r,this.browserStorage)},e}()),Wo=function(){function e(e,t){this.browserStorage=e,this.logger=t,this.unloadWindow=this.unloadWindow.bind(this)}return e.prototype.openPopup=function(t,r){try{var n=void 0;if(r.popup?(n=r.popup,this.logger.verbosePii("Navigating popup window to: "+t),n.location.assign(t)):void 0===r.popup&&(this.logger.verbosePii("Opening popup window to: "+t),n=e.openSizedPopup(t,r.popupName,r.popupWindowAttributes,this.logger)),!n)throw Eo.createEmptyWindowCreatedError();return n.focus&&n.focus(),this.currentWindow=n,window.addEventListener("beforeunload",this.unloadWindow),n}catch(e){throw this.logger.error("error opening popup "+e.message),this.browserStorage.setInteractionInProgress(!1),Eo.createPopupWindowError(e.toString())}},e.openSizedPopup=function(e,t,r,n){var o,i,a,s,c=window.screenLeft?window.screenLeft:window.screenX,u=window.screenTop?window.screenTop:window.screenY,l=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,d=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,h=null===(o=r.popupSize)||void 0===o?void 0:o.width,p=null===(i=r.popupSize)||void 0===i?void 0:i.height,f=null===(a=r.popupPosition)||void 0===a?void 0:a.top,g=null===(s=r.popupPosition)||void 0===s?void 0:s.left;return(!h||h<0||h>l)&&(n.verbose("Default popup window width used. Window width not configured or invalid."),h=An),(!p||p<0||p>d)&&(n.verbose("Default popup window height used. Window height not configured or invalid."),p=_n),(!f||f<0||f>d)&&(n.verbose("Default popup window top position used. Window top not configured or invalid."),f=Math.max(0,d/2-_n/2+u)),(!g||g<0||g>l)&&(n.verbose("Default popup window left position used. Window left not configured or invalid."),g=Math.max(0,l/2-An/2+c)),window.open(e,t,"width="+h+", height="+p+", top="+f+", left="+g+", scrollbars=yes")},e.prototype.unloadWindow=function(e){this.browserStorage.cleanRequestByInteractionType(fn.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()},e.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},e.prototype.monitorPopupForSameOrigin=function(e){var t=this;return new Promise((function(r,n){var o=setInterval((function(){if(e.closed)return t.cleanPopup(),clearInterval(o),void n(Eo.createUserCancelledError());var i=ke.EMPTY_STRING;try{i=e.location.href}catch(e){}Xt.isEmpty(i)||"about:blank"===i||(clearInterval(o),r())}),bn)}))},e.generatePopupName=function(e,t){return In+"."+e+"."+t.scopes.join("-")+"."+t.authority+"."+t.correlationId},e.generateLogoutPopupName=function(e,t){var r=t.account&&t.account.homeAccountId;return In+"."+e+"."+r+"."+t.correlationId},e}(),$o=function(){function e(e,t,r,n){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.browserRequestLogger=n}return e.prototype.handleCodeResponse=function(e,t,r,n){return ge(this,void 0,void 0,(function(){var o,i,a,s,c,u,l;return ye(this,(function(d){switch(d.label){case 0:if(this.browserRequestLogger.verbose("InteractionHandler.handleCodeResponse called"),Xt.isEmpty(e))throw Eo.createEmptyHashError(e);if(o=this.browserStorage.generateStateKey(t),!(i=this.browserStorage.getTemporaryCache(o)))throw Jt.createStateNotFoundError("Cached State");return a=this.authModule.handleFragmentResponse(e,i),s=this.browserStorage.generateNonceKey(i),c=this.browserStorage.getTemporaryCache(s),this.authCodeRequest.code=a.code,a.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(a.cloud_instance_host_name,r,n)]:[3,2];case 1:d.sent(),d.label=2;case 2:return a.nonce=c||void 0,a.state=i,a.client_info?this.authCodeRequest.clientInfo=a.client_info:(u=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=u),[4,this.authModule.acquireToken(this.authCodeRequest,a)];case 3:return l=d.sent(),this.browserStorage.cleanRequestByState(t),[2,l]}}))}))},e.prototype.updateTokenEndpointAuthority=function(e,t,r){return ge(this,void 0,void 0,(function(){var n,o;return ye(this,(function(i){switch(i.label){case 0:return n="https://"+e+"/"+t.tenant+"/",[4,vn.createDiscoveredInstance(n,r,this.browserStorage,t.options)];case 1:return o=i.sent(),this.authModule.updateAuthority(o),[2]}}))}))},e.prototype.checkCcsCredentials=function(){var e=this.browserStorage.getTemporaryCache(dn.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+e)}return null},e}(),Yo=function(e){function t(t,r,n,o){var i=e.call(this,t,r,n,o)||this;return i.popupUtils=new Wo(r,o),i}return pe(t,e),t.prototype.initiateAuthRequest=function(e,t){if(Xt.isEmpty(e))throw this.browserRequestLogger.error("Navigate url is empty"),Eo.createEmptyNavigationUriError();return this.browserStorage.setInteractionInProgress(!0),this.browserRequestLogger.infoPii("Navigate to: "+e),this.popupUtils.openPopup(e,t)},t.prototype.monitorPopupForHash=function(e){var t=this;return this.popupUtils.monitorPopupForSameOrigin(e).then((function(){var r=e.location.hash;if(Fo.clearHash(e),t.popupUtils.cleanPopup(e),!r)throw Eo.createEmptyHashError(e.location.href);if(Jr.hashContainsKnownProperties(r))return r;throw Eo.createHashDoesNotContainKnownPropertiesError()}))},t}($o),Vo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return pe(t,e),t.prototype.acquireToken=function(e){try{var t=this.preflightInteractiveRequest(e,fn.Popup),r=Wo.generatePopupName(this.config.auth.clientId,t),n=e.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(t,r,n);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var o=Wo.openSizedPopup("about:blank",r,n,this.logger);return this.acquireTokenPopupAsync(t,r,n,o)}catch(e){return Promise.reject(e)}},t.prototype.logout=function(e){try{this.logger.verbose("logoutPopup called");var t=this.initializeLogoutRequest(e),r=Wo.generateLogoutPopupName(this.config.auth.clientId,t),n=e&&e.authority,o=e&&e.mainWindowRedirectUri,i=(null==e?void 0:e.popupWindowAttributes)||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,i,n,void 0,o);this.logger.verbose("asyncPopup set to false, opening popup");var a=Wo.openSizedPopup("about:blank",r,i,this.logger);return this.logoutPopupAsync(t,r,i,n,a,o)}catch(e){return Promise.reject(e)}},t.prototype.acquireTokenPopupAsync=function(e,t,r,n){return ge(this,void 0,void 0,(function(){var o,i,a,s,c,u,l,d,h,p;return ye(this,(function(f){switch(f.label){case 0:this.logger.verbose("acquireTokenPopupAsync called"),o=this.initializeServerTelemetryManager(pn.acquireTokenPopup),f.label=1;case 1:return f.trys.push([1,7,,8]),[4,this.initializeAuthorizationCodeRequest(e)];case 2:return i=f.sent(),[4,this.createAuthCodeClient(o,e.authority)];case 3:return a=f.sent(),this.logger.verbose("Auth code client created"),[4,a.getAuthCodeUrl(e)];case 4:return s=f.sent(),c=new Yo(a,this.browserStorage,i,this.logger),u={popup:n,popupName:t,popupWindowAttributes:r},l=c.initiateAuthRequest(s,u),this.eventHandler.emitEvent(Go.POPUP_OPENED,fn.Popup,{popupWindow:l},null),[4,c.monitorPopupForHash(l)];case 5:return d=f.sent(),h=this.validateAndExtractStateFromHash(d,fn.Popup,e.correlationId),Lr.removeThrottle(this.browserStorage,this.config.auth.clientId,i),[4,c.handleCodeResponse(d,h,a.authority,this.networkClient)];case 6:return[2,f.sent()];case 7:throw p=f.sent(),n&&n.close(),p instanceof ut&&p.setCorrelationId(this.correlationId),o.cacheFailedRequest(p),this.browserStorage.cleanRequestByState(e.state),p;case 8:return[2]}}))}))},t.prototype.logoutPopupAsync=function(e,t,r,n,o,i){return ge(this,void 0,void 0,(function(){var a,s,c,u,l,d,h,p,f;return ye(this,(function(g){switch(g.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(Go.LOGOUT_START,fn.Popup,e),a=this.initializeServerTelemetryManager(pn.logoutPopup),g.label=1;case 1:return g.trys.push([1,8,,9]),[4,this.clearCacheOnLogout(e.account)];case 2:return g.sent(),this.browserStorage.setInteractionInProgress(!0),[4,this.createAuthCodeClient(a,n)];case 3:s=g.sent(),this.logger.verbose("Auth code client created"),c=s.getLogoutUri(e),this.eventHandler.emitEvent(Go.LOGOUT_SUCCESS,fn.Popup,e),u=new Wo(this.browserStorage,this.logger),l=u.openPopup(c,{popupName:t,popupWindowAttributes:r,popup:o}),this.eventHandler.emitEvent(Go.POPUP_OPENED,fn.Popup,{popupWindow:l},null),g.label=4;case 4:return g.trys.push([4,6,,7]),[4,u.monitorPopupForSameOrigin(l)];case 5:return g.sent(),this.logger.verbose("Popup successfully redirected to postLogoutRedirectUri"),[3,7];case 6:return d=g.sent(),this.logger.verbose("Error occurred while monitoring popup for same origin. Session on server may remain active. Error: "+d),[3,7];case 7:return u.cleanPopup(l),i?(h={apiId:pn.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},p=Jr.getAbsoluteUrl(i,Fo.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecing main window to: "+p),this.navigationClient.navigateInternal(p,h)):this.logger.verbose("No main window navigation requested"),[3,9];case 8:throw f=g.sent(),o&&o.close(),f instanceof ut&&f.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(Go.LOGOUT_FAILURE,fn.Popup,null,f),this.eventHandler.emitEvent(Go.LOGOUT_END,fn.Popup),a.cacheFailedRequest(f),f;case 9:return this.eventHandler.emitEvent(Go.LOGOUT_END,fn.Popup),[2]}}))}))},t}(zo),Qo=function(e){function t(t,r,n,o,i){var a=e.call(this,t,r,n,o)||this;return a.browserCrypto=i,a}return pe(t,e),t.prototype.initiateAuthRequest=function(e,t){return ge(this,void 0,void 0,(function(){var r;return ye(this,(function(n){switch(n.label){case 0:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest called"),Xt.isEmpty(e)?[3,7]:(t.redirectStartPage&&(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(dn.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setInteractionInProgress(!0),this.browserStorage.setTemporaryCache(dn.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.browserRequestLogger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+e),r={apiId:pn.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1},"function"!=typeof t.onRedirectNavigate?[3,4]:(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===t.onRedirectNavigate(e)?[3,2]:(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,t.navigationClient.navigateExternal(e,r)])));case 1:case 5:return n.sent(),[2];case 2:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,t.navigationClient.navigateExternal(e,r)];case 6:return[3,8];case 7:throw this.browserRequestLogger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Eo.createEmptyNavigationUriError();case 8:return[2]}}))}))},t.prototype.handleCodeResponse=function(e,t,r,n,o){return ge(this,void 0,void 0,(function(){var i,a,s,c,u,l,d;return ye(this,(function(h){switch(h.label){case 0:if(this.browserRequestLogger.verbose("RedirectHandler.handleCodeResponse called"),Xt.isEmpty(e))throw Eo.createEmptyHashError(e);if(this.browserStorage.setInteractionInProgress(!1),i=this.browserStorage.generateStateKey(t),!(a=this.browserStorage.getTemporaryCache(i)))throw Jt.createStateNotFoundError("Cached State");return s=this.authModule.handleFragmentResponse(e,a),c=this.browserStorage.generateNonceKey(a),u=this.browserStorage.getTemporaryCache(c),this.authCodeRequest.code=s.code,s.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(s.cloud_instance_host_name,r,n)]:[3,2];case 1:h.sent(),h.label=2;case 2:return s.nonce=u||void 0,s.state=a,s.client_info?this.authCodeRequest.clientInfo=s.client_info:(l=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=l),o&&Lr.removeThrottle(this.browserStorage,o,this.authCodeRequest),[4,this.authModule.acquireToken(this.authCodeRequest,s)];case 3:return d=h.sent(),this.browserStorage.cleanRequestByState(t),[2,d]}}))}))},t}($o),Jo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return pe(t,e),t.prototype.acquireToken=function(e){return ge(this,void 0,void 0,(function(){var t,r,n,o,i,a,s,c;return ye(this,(function(u){switch(u.label){case 0:t=this.preflightInteractiveRequest(e,fn.Redirect),r=this.initializeServerTelemetryManager(pn.acquireTokenRedirect),u.label=1;case 1:return u.trys.push([1,6,,7]),[4,this.initializeAuthorizationCodeRequest(t)];case 2:return n=u.sent(),[4,this.createAuthCodeClient(r,t.authority)];case 3:return o=u.sent(),this.logger.verbose("Auth code client created"),i=new Qo(o,this.browserStorage,n,this.logger,this.browserCrypto),[4,o.getAuthCodeUrl(t)];case 4:return a=u.sent(),s=this.getRedirectStartPage(e.redirectStartPage),this.logger.verbosePii("Redirect start page: "+s),[4,i.initiateAuthRequest(a,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:s,onRedirectNavigate:e.onRedirectNavigate})];case 5:return[2,u.sent()];case 6:throw(c=u.sent())instanceof ut&&c.setCorrelationId(this.correlationId),r.cacheFailedRequest(c),this.browserStorage.cleanRequestByState(t.state),c;case 7:return[2]}}))}))},t.prototype.handleRedirectPromise=function(e){return ge(this,void 0,void 0,(function(){var t,r,n,o,i,a,s,c,u,l,d;return ye(this,(function(h){switch(h.label){case 0:t=this.initializeServerTelemetryManager(pn.handleRedirectPromise),h.label=1;case 1:if(h.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(r=this.getRedirectResponseHash(e||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(fn.Redirect),[2,null];n=void 0;try{n=this.validateAndExtractStateFromHash(r,fn.Redirect),Fo.clearHash(window),this.logger.verbose("State extracted from hash")}catch(e){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+e),this.browserStorage.cleanRequestByInteractionType(fn.Redirect),[2,null]}return o=this.browserStorage.getTemporaryCache(dn.ORIGIN_URI,!0)||"",i=Jr.removeHashFromUrl(o),a=Jr.removeHashFromUrl(window.location.href),i===a&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(r,n,t)]):[3,3];case 2:return s=h.sent(),o.indexOf("#")>-1&&Fo.replaceHash(o),[2,s];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(r,n,t)]);case 4:return Fo.isInIframe()?[3,9]:(this.browserStorage.setTemporaryCache(dn.URL_HASH,r,!0),c={apiId:pn.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},u=!0,o&&"null"!==o?[3,6]:(l=Fo.getHomepage(),this.browserStorage.setTemporaryCache(dn.ORIGIN_URI,l,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(l,c)]));case 5:return u=h.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+o),[4,this.navigationClient.navigateInternal(o,c)];case 7:u=h.sent(),h.label=8;case 8:if(!u)return[2,this.handleHash(r,n,t)];h.label=9;case 9:return[2,null];case 10:throw(d=h.sent())instanceof ut&&d.setCorrelationId(this.correlationId),t.cacheFailedRequest(d),this.browserStorage.cleanRequestByInteractionType(fn.Redirect),d;case 11:return[2]}}))}))},t.prototype.getRedirectResponseHash=function(e){this.logger.verbose("getRedirectResponseHash called");var t=Jr.hashContainsKnownProperties(e),r=this.browserStorage.getTemporaryCache(dn.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(dn.URL_HASH)),t?(this.logger.verbose("Hash contains known properties, returning response hash"),e):(this.logger.verbose("Hash does not contain known properties, returning cached hash"),r)},t.prototype.handleHash=function(e,t,r){return ge(this,void 0,void 0,(function(){var n,o,i;return ye(this,(function(a){switch(a.label){case 0:if(n=this.browserStorage.getCachedRequest(t,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),!(o=this.browserStorage.getCachedAuthority(t)))throw Eo.createNoCachedAuthorityError();return[4,this.createAuthCodeClient(r,o)];case 1:return i=a.sent(),this.logger.verbose("Auth code client created"),[4,new Qo(i,this.browserStorage,n,this.logger,this.browserCrypto).handleCodeResponse(e,t,i.authority,this.networkClient,this.config.auth.clientId)];case 2:return[2,a.sent()]}}))}))},t.prototype.logout=function(e){return ge(this,void 0,void 0,(function(){var t,r,n,o,i,a;return ye(this,(function(s){switch(s.label){case 0:this.logger.verbose("logoutRedirect called"),t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(pn.logout),s.label=1;case 1:return s.trys.push([1,10,,11]),this.eventHandler.emitEvent(Go.LOGOUT_START,fn.Redirect,e),[4,this.clearCacheOnLogout(t.account)];case 2:return s.sent(),n={apiId:pn.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},[4,this.createAuthCodeClient(r,e&&e.authority)];case 3:return o=s.sent(),this.logger.verbose("Auth code client created"),i=o.getLogoutUri(t),this.eventHandler.emitEvent(Go.LOGOUT_SUCCESS,fn.Redirect,t),e&&"function"==typeof e.onRedirectNavigate?!1===e.onRedirectNavigate(i)?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),[4,this.navigationClient.navigateExternal(i,n)]):[3,7];case 4:return s.sent(),[2];case 5:this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),s.label=6;case 6:return[3,9];case 7:return[4,this.navigationClient.navigateExternal(i,n)];case 8:return s.sent(),[2];case 9:return[3,11];case 10:throw(a=s.sent())instanceof ut&&a.setCorrelationId(this.correlationId),r.cacheFailedRequest(a),this.eventHandler.emitEvent(Go.LOGOUT_FAILURE,fn.Redirect,null,a),this.eventHandler.emitEvent(Go.LOGOUT_END,fn.Redirect),a;case 11:return this.eventHandler.emitEvent(Go.LOGOUT_END,fn.Redirect),[2]}}))}))},t.prototype.getRedirectStartPage=function(e){var t=e||window.location.href;return Jr.getAbsoluteUrl(t,Fo.getCurrentUri())},t}(zo),Xo=function(e){function t(t,r,n,o,i){var a=e.call(this,t,r,n,o)||this;return a.navigateFrameWait=i,a}return pe(t,e),t.prototype.initiateAuthRequest=function(e){return ge(this,void 0,void 0,(function(){var t;return ye(this,(function(r){switch(r.label){case 0:if(Xt.isEmpty(e))throw this.browserRequestLogger.info("Navigate url is empty"),Eo.createEmptyNavigationUriError();return this.navigateFrameWait?[4,this.loadFrame(e)]:[3,2];case 1:return t=r.sent(),[3,3];case 2:t=this.loadFrameSync(e),r.label=3;case 3:return[2,t]}}))}))},t.prototype.monitorIframeForHash=function(e,t){var r=this;return new Promise((function(n,o){t<Ko&&r.browserRequestLogger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+t+"ms) than the default ("+"6000ms). This may result in timeouts.");var i=window.performance.now()+t,a=setInterval((function(){if(window.performance.now()>i)return r.removeHiddenIframe(e),clearInterval(a),void o(Eo.createMonitorIframeTimeoutError());var t=ke.EMPTY_STRING,s=e.contentWindow;try{t=s?s.location.href:ke.EMPTY_STRING}catch(e){}if(!Xt.isEmpty(t)){var c=s?s.location.hash:ke.EMPTY_STRING;return Jr.hashContainsKnownProperties(c)?(r.removeHiddenIframe(e),clearInterval(a),void n(c)):void 0}}),bn)}))},t.prototype.loadFrame=function(e){var t=this;return new Promise((function(r,n){var o=t.createHiddenIframe();setTimeout((function(){o?(o.src=e,r(o)):n("Unable to load iframe")}),t.navigateFrameWait)}))},t.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();return t.src=e,t},t.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e},t.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},t}($o),Zo=function(e){function t(t,r,n,o,i,a,s,c){var u=e.call(this,t,r,n,o,i,a,c)||this;return u.apiId=s,u}return pe(t,e),t.prototype.acquireToken=function(e){return ge(this,void 0,void 0,(function(){var t,r,n,o,i,a;return ye(this,(function(s){switch(s.label){case 0:if(this.logger.verbose("acquireTokenByIframe called"),Xt.isEmpty(e.loginHint)&&Xt.isEmpty(e.sid)&&(!e.account||Xt.isEmpty(e.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),e.prompt&&e.prompt!==Me.NONE)throw Eo.createSilentPromptValueError(e.prompt);t=this.initializeAuthorizationRequest(fe(fe({},e),{prompt:Me.NONE}),fn.Silent),r=this.initializeServerTelemetryManager(this.apiId),s.label=1;case 1:return s.trys.push([1,6,,7]),[4,this.initializeAuthorizationCodeRequest(t)];case 2:return n=s.sent(),[4,this.createAuthCodeClient(r,t.authority)];case 3:return o=s.sent(),this.logger.verbose("Auth code client created"),[4,o.getAuthCodeUrl(t)];case 4:return i=s.sent(),[4,this.silentTokenHelper(i,n,o,this.logger)];case 5:return[2,s.sent()];case 6:throw(a=s.sent())instanceof ut&&a.setCorrelationId(this.correlationId),r.cacheFailedRequest(a),this.browserStorage.cleanRequestByState(t.state),a;case 7:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(Eo.createSilentLogoutUnsupportedError())},t.prototype.silentTokenHelper=function(e,t,r,n){return ge(this,void 0,void 0,(function(){var o,i,a,s;return ye(this,(function(c){switch(c.label){case 0:return[4,(o=new Xo(r,this.browserStorage,t,n,this.config.system.navigateFrameWait)).initiateAuthRequest(e)];case 1:return i=c.sent(),[4,o.monitorIframeForHash(i,this.config.system.iframeHashTimeout)];case 2:return a=c.sent(),s=this.validateAndExtractStateFromHash(a,fn.Silent,t.correlationId),[2,o.handleCodeResponse(a,s,r.authority,this.networkClient)]}}))}))},t}(zo),ei=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return pe(t,e),t.prototype.acquireToken=function(e){return ge(this,void 0,void 0,(function(){var t,r,n,o=this;return ye(this,(function(i){switch(i.label){case 0:return t=fe(fe({},e),this.initializeBaseRequest(e)),r=this.initializeServerTelemetryManager(pn.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(r,t.authority)];case 1:return n=i.sent(),this.logger.verbose("Refresh token client created"),[2,n.acquireTokenByRefreshToken(t).catch((function(e){throw e instanceof ut&&e.setCorrelationId(o.correlationId),r.cacheFailedRequest(e),e}))]}}))}))},t.prototype.logout=function(){return Promise.reject(Eo.createSilentLogoutUnsupportedError())},t.prototype.createRefreshTokenClient=function(e,t){return ge(this,void 0,void 0,(function(){var r;return ye(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new on(r)]}}))}))},t}(zo),ti=function(){function e(e,t,r,n){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=n}return e.prototype.loadExternalTokens=function(e,t,r){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw Eo.createUnableToLoadTokenError("Please ensure server response includes id token.");if(e.account)this.loadIdToken(t.id_token,e.account.homeAccountId,e.account.environment,e.account.tenantId,r),this.loadAccessToken(e,t,e.account.homeAccountId,e.account.environment,e.account.tenantId,r);else{if(!e.authority)throw Eo.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");var n={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},o=new mn(e.authority,this.config.system.networkClient,this.storage,n);if(r.clientInfo)this.logger.trace("TokenCache - homeAccountId from options"),this.loadIdToken(t.id_token,r.clientInfo,o.hostnameAndPort,o.tenant,r),this.loadAccessToken(e,t,r.clientInfo,o.hostnameAndPort,o.tenant,r);else{if(!t.client_info)throw Eo.createUnableToLoadTokenError("Please provide clientInfo in the response or options.");this.logger.trace("TokenCache - homeAccountId from response"),this.loadIdToken(t.id_token,t.client_info,o.hostnameAndPort,o.tenant,r),this.loadAccessToken(e,t,t.client_info,o.hostnameAndPort,o.tenant,r)}}},e.prototype.loadIdToken=function(e,t,r,n,o){var i=Kr.createIdTokenEntity(t,r,e,this.config.auth.clientId,n),a=new _r(e,this.cryptoObj),s=o.clientInfo?Ar.createAccount(o.clientInfo,t,a,void 0,void 0,void 0,void 0,r):Ar.createGenericAccount(t,a,void 0,void 0,void 0,void 0,r);if(!this.isBrowserEnvironment)throw Eo.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.");this.logger.verbose("TokenCache - loading id token"),this.storage.setAccount(s),this.storage.setIdTokenCredential(i)},e.prototype.loadAccessToken=function(e,t,r,n,o,i){if(t.access_token){if(!t.expires_in)throw Eo.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!i.extendedExpiresOn)throw Eo.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var a=new wr(e.scopes).printScopes(),s=t.expires_in,c=i.extendedExpiresOn,u=Br.createAccessTokenEntity(r,n,t.access_token,this.config.auth.clientId,o,a,s,c,this.cryptoObj);if(!this.isBrowserEnvironment)throw Eo.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.");this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(u)}else this.logger.verbose("TokenCache - No access token provided for caching")},e}(),ri=function(){function e(e){var t,r,n,o,i,a,s,c,u,l,d,h;this.isBrowserEnvironment="undefined"!=typeof window,this.config=(t=e,r=this.isBrowserEnvironment,n=t.auth,o=t.cache,i=t.system,a={clientId:"",authority:""+ke.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:"",authorityMetadata:"",redirectUri:"",postLogoutRedirectUri:"",navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:Xr.AAD},s={cacheLocation:un.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1},c={loggerCallback:function(){},logLevel:st.Info,piiLoggingEnabled:!1},u=fe(fe({},Rr),{loggerOptions:c,networkClient:r?Fo.getBrowserNetworkClient():wn,navigationClient:new xo,loadFrameTimeout:0,windowHashTimeout:i&&i.loadFrameTimeout||6e4,iframeHashTimeout:i&&i.loadFrameTimeout||Ko,navigateFrameWait:r&&Fo.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1}),{auth:fe(fe({},a),n),cache:fe(fe({},s),o),system:fe(fe({},u),i)}),this.logger=new er(this.config.system.loggerOptions,"@azure/msal-browser",Bo),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.browserCrypto=this.isBrowserEnvironment?new _o:lt,this.eventHandler=new jo(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new Ho(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):(l=this.config.auth.clientId,d=this.logger,h={cacheLocation:un.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1},new Ho(l,h,lt,d)),this.tokenCache=new ti(this.config,this.browserStorage,this.logger,this.browserCrypto)}return e.prototype.handleRedirectPromise=function(e){return ge(this,void 0,void 0,(function(){var t,r,n,o,i,a=this;return ye(this,(function(s){return this.logger.verbose("handleRedirectPromise called"),t=this.getAllAccounts(),this.isBrowserEnvironment?(r=e||ke.EMPTY_STRING,void 0===(n=this.redirectResponse.get(r))?(this.eventHandler.emitEvent(Go.HANDLE_REDIRECT_START,fn.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),o=this.browserStorage.getTemporaryCache(dn.CORRELATION_ID,!0)||"",i=new Jo(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,o),n=i.handleRedirectPromise(e).then((function(e){e&&(t.length<a.getAllAccounts().length?(a.eventHandler.emitEvent(Go.LOGIN_SUCCESS,fn.Redirect,e),a.logger.verbose("handleRedirectResponse returned result, login success")):(a.eventHandler.emitEvent(Go.ACQUIRE_TOKEN_SUCCESS,fn.Redirect,e),a.logger.verbose("handleRedirectResponse returned result, acquire token success")));return a.eventHandler.emitEvent(Go.HANDLE_REDIRECT_END,fn.Redirect),e})).catch((function(e){throw t.length>0?a.eventHandler.emitEvent(Go.ACQUIRE_TOKEN_FAILURE,fn.Redirect,null,e):a.eventHandler.emitEvent(Go.LOGIN_FAILURE,fn.Redirect,null,e),a.eventHandler.emitEvent(Go.HANDLE_REDIRECT_END,fn.Redirect),e})),this.redirectResponse.set(r,n)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,n]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])}))}))},e.prototype.acquireTokenRedirect=function(e){return ge(this,void 0,void 0,(function(){var t,r=this;return ye(this,(function(n){return this.preflightBrowserEnvironmentCheck(fn.Redirect),this.logger.verbose("acquireTokenRedirect called"),(t=this.getAllAccounts().length>0)?this.eventHandler.emitEvent(Go.ACQUIRE_TOKEN_START,fn.Redirect,e):this.eventHandler.emitEvent(Go.LOGIN_START,fn.Redirect,e),[2,new Jo(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.correlationId).acquireToken(e).catch((function(e){throw t?r.eventHandler.emitEvent(Go.ACQUIRE_TOKEN_FAILURE,fn.Redirect,null,e):r.eventHandler.emitEvent(Go.LOGIN_FAILURE,fn.Redirect,null,e),e}))]}))}))},e.prototype.acquireTokenPopup=function(e){var t=this;try{this.preflightBrowserEnvironmentCheck(fn.Popup),this.logger.verbose("acquireTokenPopup called",e.correlationId)}catch(e){return Promise.reject(e)}var r=this.getAllAccounts();return r.length>0?this.eventHandler.emitEvent(Go.ACQUIRE_TOKEN_START,fn.Popup,e):this.eventHandler.emitEvent(Go.LOGIN_START,fn.Popup,e),new Vo(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.correlationId).acquireToken(e).then((function(e){return r.length<t.getAllAccounts().length?t.eventHandler.emitEvent(Go.LOGIN_SUCCESS,fn.Popup,e):t.eventHandler.emitEvent(Go.ACQUIRE_TOKEN_SUCCESS,fn.Popup,e),e})).catch((function(e){return r.length>0?t.eventHandler.emitEvent(Go.ACQUIRE_TOKEN_FAILURE,fn.Popup,null,e):t.eventHandler.emitEvent(Go.LOGIN_FAILURE,fn.Popup,null,e),Promise.reject(e)}))},e.prototype.ssoSilent=function(e){return ge(this,void 0,void 0,(function(){var t,r;return ye(this,(function(n){switch(n.label){case 0:this.preflightBrowserEnvironmentCheck(fn.Silent),this.logger.verbose("ssoSilent called",e.correlationId),this.eventHandler.emitEvent(Go.SSO_SILENT_START,fn.Silent,e),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,new Zo(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,pn.ssoSilent,e.correlationId).acquireToken(e)];case 2:return t=n.sent(),this.eventHandler.emitEvent(Go.SSO_SILENT_SUCCESS,fn.Silent,t),[2,t];case 3:throw r=n.sent(),this.eventHandler.emitEvent(Go.SSO_SILENT_FAILURE,fn.Silent,null,r),r;case 4:return[2]}}))}))},e.prototype.acquireTokenByRefreshToken=function(e){return ge(this,void 0,void 0,(function(){var t=this;return ye(this,(function(r){return this.eventHandler.emitEvent(Go.ACQUIRE_TOKEN_NETWORK_START,fn.Silent,e),Fo.blockReloadInHiddenIframes(),[2,new ei(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,e.correlationId).acquireToken(e).catch((function(r){var n=r instanceof Mr,o=r instanceof Yr,i=r.errorCode===Sn;if(n&&i&&!o)return t.logger.verbose("Refresh token expired or invalid, attempting acquire token by iframe",e.correlationId),new Zo(t.config,t.browserStorage,t.browserCrypto,t.logger,t.eventHandler,t.navigationClient,pn.acquireTokenSilent_authCode).acquireToken(e);throw r}))]}))}))},e.prototype.logout=function(e){return ge(this,void 0,void 0,(function(){return ye(this,(function(t){return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead."),[2,this.logoutRedirect(e)]}))}))},e.prototype.logoutRedirect=function(e){return ge(this,void 0,void 0,(function(){return ye(this,(function(t){return this.preflightBrowserEnvironmentCheck(fn.Redirect),[2,new Jo(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,null==e?void 0:e.correlationId).logout(e)]}))}))},e.prototype.logoutPopup=function(e){try{return this.preflightBrowserEnvironmentCheck(fn.Popup),new Vo(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,null==e?void 0:e.correlationId).logout(e)}catch(e){return Promise.reject(e)}},e.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},e.prototype.getAccountByUsername=function(e){var t=this.getAllAccounts();return!Xt.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching username found, returning"),this.logger.verbosePii("Returning signed-in accounts matching username: "+e),t.filter((function(t){return t.username.toLowerCase()===e.toLowerCase()}))[0]||null):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},e.prototype.getAccountByHomeId=function(e){var t=this.getAllAccounts();return!Xt.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching homeAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching homeAccountId: "+e),t.filter((function(t){return t.homeAccountId===e}))[0]||null):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},e.prototype.getAccountByLocalId=function(e){var t=this.getAllAccounts();return!Xt.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching localAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching localAccountId: "+e),t.filter((function(t){return t.localAccountId===e}))[0]||null):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},e.prototype.setActiveAccount=function(e){this.browserStorage.setActiveAccount(e)},e.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},e.prototype.preflightBrowserEnvironmentCheck=function(e){if(this.logger.verbose("preflightBrowserEnvironmentCheck started"),Fo.blockNonBrowserEnvironment(this.isBrowserEnvironment),Fo.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),Fo.blockReloadInHiddenIframes(),Fo.blockAcquireTokenInPopups(),e===fn.Redirect&&this.config.cache.cacheLocation===un.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw Po.createInMemoryRedirectUnavailableError()},e.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)},e.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)},e.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},e.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},e.prototype.getTokenCache=function(){return this.tokenCache},e.prototype.getLogger=function(){return this.logger},e.prototype.setLogger=function(e){this.logger=e},e.prototype.initializeWrapperLibrary=function(e,t){this.browserStorage.setWrapperMetadata(e,t)},e.prototype.setNavigationClient=function(e){this.navigationClient=e},e}(),ni=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return pe(t,e),t.prototype.acquireToken=function(e){return ge(this,void 0,void 0,(function(){var t,r,n,o;return ye(this,(function(i){switch(i.label){case 0:return t=this.initializeServerTelemetryManager(pn.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(t,e.authority)];case 1:r=i.sent(),this.logger.verbose("Silent auth client created"),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,r.acquireCachedToken(e)];case 3:return n=i.sent(),this.eventHandler.emitEvent(Go.ACQUIRE_TOKEN_SUCCESS,fn.Silent,n),[2,n];case 4:throw(o=i.sent())instanceof Eo&&o.errorCode===vo.code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),o;case 5:return[2]}}))}))},t.prototype.logout=function(){return Promise.reject(Eo.createSilentLogoutUnsupportedError())},t.prototype.createSilentFlowClient=function(e,t){return ge(this,void 0,void 0,(function(){var r;return ye(this,(function(n){switch(n.label){case 0:return[4,this.getClientConfiguration(e,t)];case 1:return r=n.sent(),[2,new an(r)]}}))}))},t.prototype.initializeSilentRequest=function(e,t){return fe(fe(fe({},e),this.initializeBaseRequest(e)),{account:t,forceRefresh:e.forceRefresh||!1})},t}(zo);
/*! @azure/msal-browser v2.18.0 2021-10-05 */const oi=new(function(e){function t(t){var r=e.call(this,t)||this;return r.activeSilentTokenRequests=new Map,r}return pe(t,e),t.prototype.loginRedirect=function(e){return ge(this,void 0,void 0,(function(){return ye(this,(function(t){return this.logger.verbose("loginRedirect called"),[2,this.acquireTokenRedirect(e||kn)]}))}))},t.prototype.loginPopup=function(e){return this.logger.verbose("loginPopup called"),this.acquireTokenPopup(e||kn)},t.prototype.acquireTokenSilent=function(e){return ge(this,void 0,void 0,(function(){var t,r,n,o,i,a=this;return ye(this,(function(s){if(this.preflightBrowserEnvironmentCheck(fn.Silent),this.logger.verbose("acquireTokenSilent called",e.correlationId),!(t=e.account||this.getActiveAccount()))throw Eo.createNoAccountError();return r={clientId:this.config.auth.clientId,authority:e.authority||"",scopes:e.scopes,homeAccountIdentifier:t.homeAccountId,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims},n=JSON.stringify(r),void 0===(o=this.activeSilentTokenRequests.get(n))?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",e.correlationId),i=this.acquireTokenSilentAsync(e,t).then((function(e){return a.activeSilentTokenRequests.delete(n),e})).catch((function(e){throw a.activeSilentTokenRequests.delete(n),e})),this.activeSilentTokenRequests.set(n,i),[2,i]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",e.correlationId),[2,o])}))}))},t.prototype.acquireTokenSilentAsync=function(e,t){return ge(this,void 0,void 0,(function(){var r,n,o=this;return ye(this,(function(i){return r=new ni(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient),n=r.initializeSilentRequest(e,t),this.eventHandler.emitEvent(Go.ACQUIRE_TOKEN_START,fn.Silent,e),[2,r.acquireToken(n).catch((function(){return ge(o,void 0,void 0,(function(){var e,t;return ye(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.acquireTokenByRefreshToken(n)];case 1:return e=r.sent(),this.eventHandler.emitEvent(Go.ACQUIRE_TOKEN_SUCCESS,fn.Silent,e),[2,e];case 2:throw t=r.sent(),this.eventHandler.emitEvent(Go.ACQUIRE_TOKEN_FAILURE,fn.Silent,null,t),t;case 3:return[2]}}))}))}))]}))}))},t}(ri))({auth:{clientId:"729075f3-de08-4e95-9b85-c668d381fa73",authority:"https://login.microsoftonline.com/5761859f-ee63-474e-8746-4ddcc0d3e9e5",redirectUri:window.location.href}});function ii(){const e=oi.getAllAccounts();if(1===e.length)return e[0];if(e.length>1)throw"Too many accounts!";return null}const ai={scopes:[]};async function si(){await oi.loginPopup(ai)}async function ci(){await oi.logoutRedirect({onRedirectNavigate:()=>!1})}const ui=function(){const{subscribe:e,set:t}=re(null);return t(ii()),oi.addEventCallback((e=>{const{eventType:r}=e;switch(r){case Go.LOGIN_SUCCESS:case Go.LOGOUT_SUCCESS:t(ii())}})),{subscribe:e}}(),li=ne(ui,(e=>e?e.name:void 0)),di=ne(ui,(e=>Boolean(e)));function hi(t){let r,n;return r=new ee({props:{handler:si,name:"Login"}}),{c(){q(r.$$.fragment)},m(e,t){F(r,e,t),n=!0},p:e,i(e){n||(H(r.$$.fragment,e),n=!0)},o(e){D(r.$$.fragment,e),n=!1},d(e){x(r,e)}}}function pi(e){let t,r,n,o,i;return o=new ee({props:{handler:ci,name:"Logout"}}),{c(){t=h("p"),r=f(e[1]),n=g(),q(o.$$.fragment),y(t,"class","svelte-ojk4pc")},m(e,a){l(e,t,a),u(t,r),l(e,n,a),F(o,e,a),i=!0},p(e,t){(!i||2&t)&&m(r,e[1])},i(e){i||(H(o.$$.fragment,e),i=!0)},o(e){D(o.$$.fragment,e),i=!1},d(e){e&&d(t),e&&d(n),x(o,e)}}}function fi(e){let t,r,n,o,i,a,s;const c=[pi,hi],p=[];function f(e,t){return e[0]?0:1}return i=f(e),a=p[i]=c[i](e),{c(){t=h("div"),r=h("header"),n=h("h1"),n.textContent="Open Innovations Delivery",o=g(),a.c(),y(n,"class","svelte-ojk4pc"),y(r,"class","svelte-ojk4pc"),y(t,"class","svelte-ojk4pc")},m(e,a){l(e,t,a),u(t,r),u(r,n),u(r,o),p[i].m(r,null),s=!0},p(e,[t]){let n=i;i=f(e),i===n?p[i].p(e,t):(M(),D(p[n],1,1,(()=>{p[n]=null})),L(),a=p[i],a?a.p(e,t):(a=p[i]=c[i](e),a.c()),H(a,1),a.m(r,null))},i(e){s||(H(a),s=!0)},o(e){D(a),s=!1},d(e){e&&d(t),p[i].d()}}}function gi(e,t,r){let n,o;return c(e,di,(e=>r(0,n=e))),c(e,li,(e=>r(1,o=e))),[n,o]}class yi extends B{constructor(e){super(),G(this,e,gi,fi,a,{})}}function mi(t){let r,n,o,i,a,s,c;return i=new ee({props:{handler:si,name:"Enter"}}),{c(){r=h("section"),n=h("p"),n.textContent="Welcome to the Delivery Opsroom",o=g(),q(i.$$.fragment),a=g(),s=h("figure"),s.innerHTML='<img src="https://damn-8791.kxcdn.com/wp-content/uploads/2012/10/control-room-large-21.jpg" alt="A room with a circle of seven chairs facing inwards. The chairs are white with orange upholstery and are very futurustic looking. They have large orange control pads with a white buttons in various geometric shapes at the end of the right arm. The walls, which are wood panelled, are covered with video screens and control panels." class="svelte-1nvt45k"/> \n    <figcaption class="svelte-1nvt45k">The Operations Room of <a href="https://en.wikipedia.org/wiki/Project_Cybersyn">Project Cybersyn</a>, Chile&#39;s 1970&#39;s experiment in Cybernetics.</figcaption>',y(r,"class","svelte-1nvt45k")},m(e,t){l(e,r,t),u(r,n),u(r,o),F(i,r,null),u(r,a),u(r,s),c=!0},p:e,i(e){c||(H(i.$$.fragment,e),c=!0)},o(e){D(i.$$.fragment,e),c=!1},d(e){e&&d(r),x(i)}}}class vi extends B{constructor(e){super(),G(this,e,null,mi,a,{})}}function Ei(e){let t,r;return t=new vi({}),{c(){q(t.$$.fragment)},m(e,n){F(t,e,n),r=!0},i(e){r||(H(t.$$.fragment,e),r=!0)},o(e){D(t.$$.fragment,e),r=!1},d(e){x(t,e)}}}function Ci(e){let t,r;return t=new de({}),{c(){q(t.$$.fragment)},m(e,n){F(t,e,n),r=!0},i(e){r||(H(t.$$.fragment,e),r=!0)},o(e){D(t.$$.fragment,e),r=!1},d(e){x(t,e)}}}function wi(e){let t,r,n,o,i,a;t=new yi({});const s=[Ci,Ei],c=[];function u(e,t){return e[0]?0:1}return o=u(e),i=c[o]=s[o](e),{c(){q(t.$$.fragment),r=g(),n=h("main"),i.c(),y(n,"role","main"),y(n,"class","svelte-jtub51")},m(e,i){F(t,e,i),l(e,r,i),l(e,n,i),c[o].m(n,null),a=!0},p(e,[t]){let r=o;o=u(e),o!==r&&(M(),D(c[r],1,1,(()=>{c[r]=null})),L(),i=c[o],i||(i=c[o]=s[o](e),i.c()),H(i,1),i.m(n,null))},i(e){a||(H(t.$$.fragment,e),H(i),a=!0)},o(e){D(t.$$.fragment,e),D(i),a=!1},d(e){x(t,e),e&&d(r),e&&d(n),c[o].d()}}}function Ti(e,t,r){let n;return c(e,di,(e=>r(0,n=e))),[n]}return new class extends B{constructor(e){super(),G(this,e,Ti,wi,a,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
